(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    245636,       5866]
NotebookOptionsPosition[    242610,       5776]
NotebookOutlinePosition[    243086,       5796]
CellTagsIndexPosition[    243043,       5793]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"repoDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$InitialDirectory", ",", "\"\<Dropbox\>\"", ",", "\"\<Archives\>\"", 
      ",", "\"\<GitHub\>\"", ",", "\"\<SunMotion\>\""}], "}"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.560286697556589*^9, {3.562017385212695*^9, 3.5620173867317*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute dayAngleLongZero, sunAngleCircular, \
sunAngleElliptical", "Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.561571937865049*^9, 3.5615719382651587`*^9}, {3.56201313983422*^9, 
  3.5620131419218407`*^9}, {3.562013240274948*^9, 3.5620132429946423`*^9}, {
  3.5623465238152533`*^9, 3.562346569790494*^9}, {3.562346625904853*^9, 
  3.56234664499936*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vernalEquinoxDateTime", "=", 
   RowBox[{"DateList", "[", "\"\<20 Mar 2012 05:14:00\>\"", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"vernalEquinoxDateTime", "=", 
    RowBox[{"DateList", "[", "\"\<20 Mar 2012 00:00:00\>\"", "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"perihelionDateTime", "=", 
  RowBox[{
  "DateList", "[", "\"\<2 January 2013 04:38:00\>\"", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbDay", "=", "366"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yearLength", "=", "365.2425"}], 
   RowBox[{"(*", "365.2425", "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"vernalEquinoxDate12AM", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vernalEquinoxDateTime", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"vernalEquinoxDateTime", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"vernalEquinoxDateTime", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startDateTime", "=", "vernalEquinoxDate12AM"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "can", " ", "be", " ", "any", " ", "day", " ", "but", " ", "must", " ", 
    "be", " ", "12", "AM"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStepinMinute", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"timeStepPerHour", "=", 
  RowBox[{"Round", "[", 
   RowBox[{"60", "/", "timeStepinMinute"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timeStepPerDay", "=", 
  RowBox[{"timeStepPerHour", "*", "24"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStepPerYear", "=", 
    RowBox[{"timeStepPerDay", "*", "365"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"defined", " ", "as", " ", "365", " ", "days"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"nbTimeStep", "=", 
  RowBox[{"timeStepPerDay", "*", "nbDay"}]}], "\[IndentingNewLine]", 
 RowBox[{"offsetNbTimeStep", "=", 
  RowBox[{"Round", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"DateDifference", "[", 
       RowBox[{
       "vernalEquinoxDateTime", ",", "startDateTime", ",", "\"\<Minute\>\""}],
        "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", "timeStepinMinute"}], ")"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dayAngleInit", "=", 
  RowBox[{"N", "@", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"180", "+", 
      RowBox[{"360", "*", 
       RowBox[{"(", 
        RowBox[{"366", "/", "365"}], ")"}], "*", 
       RowBox[{"offsetNbTimeStep", "/", "timeStepPerDay"}]}]}], ",", "360"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"dayAngleArrayLongZero", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"dayAngleInit", "+", 
         RowBox[{"360", "*", 
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"366", "/", "365"}], ")"}], "/", "timeStepPerDay"}]}]}], 
        ",", "360"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "nbTimeStep"}], "}"}]}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"dayAngleArrayLongZero", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "10"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dayAngleArrayLongZero", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"-", "10"}], ";;"}], "]"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sunAngleInit", "=", 
   RowBox[{"N", "@", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"360", "*", 
       RowBox[{"(", 
        RowBox[{"365", "/", "yearLength"}], ")"}], "*", 
       RowBox[{"offsetNbTimeStep", "/", "timeStepPerYear"}]}], ",", "360"}], 
     "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"earth", " ", "on", " ", "a", " ", "circular", " ", "orbit"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"sunAngleArrayCircular", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"sunAngleInit", "+", 
          RowBox[{"360", "*", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"365", "/", "yearLength"}], ")"}], "/", 
            "timeStepPerYear"}]}]}], ",", "360"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nbTimeStep"}], "}"}]}], "]"}]}], ";"}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"earth", " ", "on", " ", "an", " ", "elliptical", " ", "orbit"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"sunAngleInit", "=", 
  RowBox[{"N", "@", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"360", "*", 
      RowBox[{"(", 
       RowBox[{"365", "/", "yearLength"}], ")"}], "*", 
      RowBox[{"offsetNbTimeStep", "/", "timeStepPerYear"}]}], ",", "360"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sunAngularSpeed", "[", "t_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e", "=", "0.0167"}], ",", 
        RowBox[{"T", "=", "yearLength"}], ",", "M", ",", "formula"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "t", " ", "is", " ", "the", " ", "time", " ", "span", " ", "after", 
         " ", "passage", " ", "through", " ", "the", " ", "perihelion"}], ",",
         " ", 
        RowBox[{"in", " ", "days"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        FractionBox[
         RowBox[{"2", "Pi", " ", "t"}], "T"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "formula", " ", "is", " ", "the", " ", "angular", " ", "speed", " ", 
         "in", " ", "radian", " ", "per", " ", "day"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"formula", "=", 
        RowBox[{
         FractionBox[
          RowBox[{"2", "Pi"}], "T"], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", "e", " ", 
            RowBox[{"Cos", "[", "M", "]"}]}], "+", 
           RowBox[{
            FractionBox["5", "2"], 
            SuperscriptBox["e", "2"], 
            RowBox[{"Cos", "[", 
             RowBox[{"2", "M"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["e", "3"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", "4"]}], 
               RowBox[{"Cos", "[", "M", "]"}]}], "+", 
              RowBox[{
               FractionBox["13", "4"], 
               RowBox[{"Cos", "[", 
                RowBox[{"3", "M"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"formula", "=", 
          RowBox[{
           FractionBox[
            RowBox[{"2", "Pi"}], "T"], "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", "e", " ", 
              RowBox[{"Cos", "[", "M", "]"}]}], "+", 
             RowBox[{
              FractionBox["5", "2"], 
              SuperscriptBox["e", "2"], 
              RowBox[{"Cos", "[", 
               RowBox[{"2", "M"}], "]"}]}]}], ")"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"N", "[", "formula", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sunAngularSpeed", "[", "t", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "365.25"}]}]}], "}"}], "*", 
       RowBox[{"360", "/", 
        RowBox[{"(", 
         RowBox[{"2", "Pi"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "365.2524"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "365.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.95", ",", "1.03"}], "}"}]}], "}"}]}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datetimeToTimestep", "[", "datetime_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"DateDifference", "[", 
        RowBox[{
        "startDateTime", ",", " ", "datetime", ",", "\"\<Minute\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"1", "+", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "timeStepinMinute"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"perihelionTimeStep", "=", 
  RowBox[{
  "datetimeToTimestep", "[", "perihelionDateTime", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sunAngularSpeedPerTimeStep", "[", "timeStep_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"timeStep", "-", "perihelionTimeStep"}], ")"}], "/", 
         "timeStepPerDay"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sunAngularSpeed", "[", "t", "]"}], "*", 
        RowBox[{"360", "/", 
         RowBox[{"(", 
          RowBox[{"2", "Pi", "*", "timeStepPerDay"}], ")"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"sunAngleArrayElliptical", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"#1", "+", 
             RowBox[{
              RowBox[{"sunAngularSpeedPerTimeStep", "[", "#2", "]"}], "*", 
              "timeStepinMinute"}]}], ",", "360"}], "]"}], ")"}], "&"}], ",", 
        "sunAngleInit", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"nbTimeStep", "-", "1"}], "]"}]}], "]"}]}], ";"}], "]"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"name", "=", "\"\<sunAngleArrayElliptical365\>\""}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", "\"\<sunAngleArrayElliptical3652425\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"sunAngleArrayElliptical", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Tables\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.csv\>\""}]}], "}"}], "]"}], ",", 
       "Real"}], "]"}]}], ";"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "sunAngleArrayCircular", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "sunAngleArrayElliptical", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"sunAngleArrayCircular", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "10"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"sunAngleArrayCircular", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "10"}], ";;"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"sunAngleArrayElliptical", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "10"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"sunAngleArrayElliptical", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "10"}], ";;"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sunAngleArrayEllipticalMinusCircular", "=", 
   RowBox[{"sunAngleArrayElliptical", "-", "sunAngleArrayCircular"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sunAngleArrayEllipticalMinusCircular", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sunAngleArrayEllipticalMinusCircular", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ">", "5"}], " ", "||", " ", 
        RowBox[{
         RowBox[{"sunAngleArrayEllipticalMinusCircular", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<", 
         RowBox[{"-", "5"}]}]}], ",", "\[IndentingNewLine]", "0", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sunAngleArrayEllipticalMinusCircular", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "sunAngleArrayCircular", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"sunAngleArrayEllipticalMinusCircular", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", 
     RowBox[{"Length", "[", "sunAngleArrayEllipticalMinusCircular", "]"}], ";;",
      "1440"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"offsetSunAngleArray", "=", 
  RowBox[{
  "Mean", "[", "sunAngleArrayEllipticalMinusCircular", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", "sunAngleArrayEllipticalMinusCircular", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Min", "[", "sunAngleArrayEllipticalMinusCircular", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.560282086394463*^9, 3.560282135250228*^9}, {
   3.560282296387278*^9, 3.560282425629318*^9}, {3.5602824811756783`*^9, 
   3.560282612487402*^9}, 3.560282652271654*^9, {3.560283309535898*^9, 
   3.560283313404559*^9}, {3.5602833455811234`*^9, 3.560283370340654*^9}, {
   3.5602834322058764`*^9, 3.560283457941298*^9}, {3.560283549158087*^9, 
   3.560283549301751*^9}, 3.560283592279151*^9, {3.560283695086793*^9, 
   3.560283812951172*^9}, 3.5602838477765703`*^9, {3.560283891160129*^9, 
   3.5602840364498587`*^9}, 3.560284116691133*^9, {3.560284171588606*^9, 
   3.560284209131652*^9}, {3.560284431558552*^9, 3.56028444048508*^9}, {
   3.560284836001614*^9, 3.5602849120563917`*^9}, {3.560285032281157*^9, 
   3.5602850983059998`*^9}, {3.560285147493112*^9, 3.560285162659931*^9}, {
   3.560285288987975*^9, 3.560285293026102*^9}, 3.560285396173235*^9, {
   3.5602854310233*^9, 3.5602855008451633`*^9}, {3.5602856073023043`*^9, 
   3.560285617973812*^9}, {3.560285702494977*^9, 3.560285703374482*^9}, {
   3.560285831975478*^9, 3.560285864159608*^9}, {3.560285904152225*^9, 
   3.560285917096157*^9}, 3.560286040176017*^9, {3.5602866632512827`*^9, 
   3.56028666340414*^9}, {3.560286766637753*^9, 3.560286767182365*^9}, {
   3.560287670149619*^9, 3.560287674773389*^9}, {3.560287707862751*^9, 
   3.560287708597831*^9}, {3.560288052648829*^9, 3.5602880548001623`*^9}, {
   3.5603673164870577`*^9, 3.560367343967125*^9}, {3.5603768090882063`*^9, 
   3.560376826350403*^9}, {3.56037765431597*^9, 3.560377687192708*^9}, {
   3.560377720825314*^9, 3.5603777326313887`*^9}, {3.5603777880410833`*^9, 
   3.5603778025325727`*^9}, {3.560377917857267*^9, 3.560377923867934*^9}, {
   3.5603780921147203`*^9, 3.560378107106778*^9}, {3.5603781372197847`*^9, 
   3.560378155956171*^9}, 3.560378332916895*^9, {3.56037840130162*^9, 
   3.560378419853537*^9}, {3.560378793029743*^9, 3.56037879741473*^9}, {
   3.560451642155085*^9, 3.560451642650834*^9}, {3.560451707420939*^9, 
   3.560451726971716*^9}, {3.560457638658101*^9, 3.560457640945868*^9}, {
   3.560459156383624*^9, 3.560459186735815*^9}, {3.560460599716535*^9, 
   3.560460700768016*^9}, 3.560461079546776*^9, {3.560461130723652*^9, 
   3.560461134706788*^9}, 3.560461393518564*^9, {3.5604614388714743`*^9, 
   3.560461465061885*^9}, {3.560461555789535*^9, 3.560461597215435*^9}, {
   3.56046231747773*^9, 3.5604623232290277`*^9}, {3.560533416896955*^9, 
   3.560533418626793*^9}, {3.560533596964508*^9, 3.560533647763258*^9}, {
   3.560536648068039*^9, 3.5605366611016903`*^9}, {3.560539625132653*^9, 
   3.560539691150464*^9}, {3.560540536630567*^9, 3.560540632791568*^9}, {
   3.560540725516646*^9, 3.56054072566741*^9}, 3.560541456615299*^9, 
   3.56157179241372*^9, {3.561577366256751*^9, 3.5615773777880793`*^9}, {
   3.561577551914486*^9, 3.561577563112543*^9}, {3.5615776221923647`*^9, 
   3.56157762233206*^9}, {3.561577710493058*^9, 3.5615777740509644`*^9}, {
   3.561577814600608*^9, 3.561577902810885*^9}, {3.561578018863387*^9, 
   3.561578021770795*^9}, {3.561578085235211*^9, 3.561578179095388*^9}, 
   3.561578320280683*^9, 3.561578365782312*^9, {3.561578678528796*^9, 
   3.561578731736986*^9}, {3.561578782521263*^9, 3.561578845391721*^9}, {
   3.56157890260082*^9, 3.5615789136359587`*^9}, 3.561578955952443*^9, 
   3.5615791763185863`*^9, {3.5615792074482203`*^9, 3.561579238308381*^9}, {
   3.5615818528126574`*^9, 3.561581856706915*^9}, 3.561584453920836*^9, {
   3.561584870621265*^9, 3.561584881923489*^9}, {3.5615849226522007`*^9, 
   3.561584946415852*^9}, {3.561585001479246*^9, 3.561585047306961*^9}, {
   3.5615850815962954`*^9, 3.561585115533477*^9}, {3.561648266906043*^9, 
   3.561648274581478*^9}, {3.5616489708351927`*^9, 3.561648971395492*^9}, {
   3.561651543660713*^9, 3.5616515447271833`*^9}, {3.561653015264093*^9, 
   3.5616530157309103`*^9}, {3.561654839617145*^9, 3.561654852184311*^9}, {
   3.561654933765813*^9, 3.561655005444542*^9}, {3.561655154096715*^9, 
   3.5616551708327637`*^9}, {3.561655208635983*^9, 3.5616552142664413`*^9}, {
   3.561746908141341*^9, 3.5617469131159067`*^9}, {3.561747931797351*^9, 
   3.5617479528375463`*^9}, 3.5617499077886066`*^9, {3.561751003865099*^9, 
   3.5617510328351717`*^9}, {3.561751089975689*^9, 3.5617510957952003`*^9}, {
   3.561751181526682*^9, 3.561751204553019*^9}, 3.561752218113572*^9, {
   3.561753893665386*^9, 3.561753894159502*^9}, 3.561755458183791*^9, {
   3.561833367237802*^9, 3.5618333881381283`*^9}, {3.5618334419671993`*^9, 
   3.561833472362998*^9}, {3.561833515942519*^9, 3.561833570215493*^9}, {
   3.561833601103547*^9, 3.5618336366795673`*^9}, {3.5618336829365377`*^9, 
   3.56183372444868*^9}, {3.561833775753183*^9, 3.561833808593257*^9}, {
   3.5618371124895887`*^9, 3.5618371274423847`*^9}, {3.561837162368443*^9, 
   3.561837166200328*^9}, 3.561917058951667*^9, {3.56191708940812*^9, 
   3.561917090617154*^9}, {3.5619172255748262`*^9, 3.561917225689966*^9}, {
   3.5619201337449627`*^9, 3.561920136734314*^9}, {3.561931339883073*^9, 
   3.561931340412249*^9}, {3.5620131514805403`*^9, 3.562013164413591*^9}, 
   3.562013214224072*^9, {3.5620132500478354`*^9, 3.5620133386988993`*^9}, {
   3.562013371807867*^9, 3.56201339789079*^9}, {3.56201344815352*^9, 
   3.562013569199871*^9}, {3.562013627251575*^9, 3.562013718782186*^9}, {
   3.5620138691206636`*^9, 3.5620139094268*^9}, {3.562013944537548*^9, 
   3.562013955738344*^9}, {3.5620147152470827`*^9, 3.562014715429782*^9}, {
   3.562014808229589*^9, 3.562014811394298*^9}, 3.56201545371382*^9, 
   3.5620172834520817`*^9, {3.562017407165639*^9, 3.5620174115780697`*^9}, {
   3.5621079898131723`*^9, 3.562108041172881*^9}, {3.5621400365387506`*^9, 
   3.562140105099236*^9}, 3.562140273897859*^9, {3.5621403411896048`*^9, 
   3.5621403727482767`*^9}, 3.562140413786571*^9, 3.562140522945444*^9, {
   3.5621678323931913`*^9, 3.562167852977622*^9}, {3.5621802098656673`*^9, 
   3.562180276078665*^9}, 3.5621803570367203`*^9, 3.562180417869382*^9, {
   3.562180569129424*^9, 3.562180578168435*^9}, {3.5621806788887453`*^9, 
   3.562180726157336*^9}, {3.5621809129350243`*^9, 3.562180940487433*^9}, 
   3.5621810302637653`*^9, {3.562181101447966*^9, 3.562181147598544*^9}, {
   3.5621818873225403`*^9, 3.5621819486421623`*^9}, {3.562182029559785*^9, 
   3.5621820343704157`*^9}, {3.562183370802516*^9, 3.5621833710018177`*^9}, {
   3.562229609819751*^9, 3.562229611517447*^9}, {3.5622612767027197`*^9, 
   3.562261308833003*^9}, {3.562261385359456*^9, 3.5622614059455223`*^9}, {
   3.56226178847992*^9, 3.56226179189495*^9}, {3.562264439393317*^9, 
   3.562264441752018*^9}, {3.5622662691057*^9, 3.56226627235281*^9}, {
   3.5622677720976133`*^9, 3.562267798859226*^9}, {3.5622681427337503`*^9, 
   3.562268157407833*^9}, {3.562270743431656*^9, 3.562270744195788*^9}, {
   3.562273664429348*^9, 3.562273704893469*^9}, {3.562273936145946*^9, 
   3.562273972424131*^9}, {3.5622740673857527`*^9, 3.56227406916451*^9}, {
   3.562275097949791*^9, 3.562275211540065*^9}, {3.562275266279646*^9, 
   3.562275271303512*^9}, {3.562275365767647*^9, 3.562275366376404*^9}, {
   3.5623461884510508`*^9, 3.5623461926033363`*^9}, {3.562346352746564*^9, 
   3.5623463528803177`*^9}, {3.5623464804181433`*^9, 3.5623464943331327`*^9}, 
   3.5623466028187838`*^9, {3.562346669716158*^9, 3.5623467350189953`*^9}, {
   3.562346957736719*^9, 3.562346961230823*^9}, {3.5623469985320673`*^9, 
   3.5623471141559362`*^9}, {3.562347233011656*^9, 3.56234728370597*^9}, {
   3.562347318223997*^9, 3.5623473513956957`*^9}, {3.562347476836128*^9, 
   3.5623474796829643`*^9}, {3.562347593278075*^9, 3.5623476209711943`*^9}, 
   3.562348689508123*^9, 3.5623487239656057`*^9, {3.5623490193460217`*^9, 
   3.562349034205338*^9}, 3.5623494757184267`*^9, 3.562349517622149*^9, {
   3.562349942616596*^9, 3.562349943032124*^9}, {3.5623499842934113`*^9, 
   3.5623500150317287`*^9}, {3.562350067682191*^9, 3.562350100501501*^9}, {
   3.562350186277182*^9, 3.5623501921416597`*^9}, {3.5623503493421183`*^9, 
   3.562350349926729*^9}, {3.562350444097131*^9, 3.5623504492849903`*^9}, {
   3.5623506360558023`*^9, 3.562350636176105*^9}, {3.562354882174247*^9, 
   3.562354890760878*^9}, {3.562355359759115*^9, 3.56235536900084*^9}, {
   3.562688376183427*^9, 3.56268837668653*^9}, {3.5626950284479713`*^9, 
   3.562695029098403*^9}, {3.562842717168685*^9, 3.5628427261105843`*^9}, {
   3.562843469508957*^9, 3.56284347179327*^9}, {3.562844023101047*^9, 
   3.562844062891761*^9}, {3.562844705827961*^9, 3.562844706428029*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Save", "Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.5615719326120167`*^9, 3.5615719331289463`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"name", "=", "\"\<sunAngleArrayElliptical365\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Tables\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.csv\>\""}]}], "}"}], "]"}], ",", 
       "sunAngleArrayElliptical"}], "]"}], ";"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.562013990395691*^9, 3.562013994404098*^9}, 
   3.562093387477147*^9, {3.562261763988097*^9, 3.5622617797956657`*^9}, 
   3.5623467255656357`*^9, 3.562350143133666*^9, {3.562350283578809*^9, 
   3.562350301310088*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"name", "=", "\"\<sunAngleArrayElliptical3652425\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Tables\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.csv\>\""}]}], "}"}], "]"}], ",", 
       "sunAngleArrayElliptical"}], "]"}], ";"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5623501585228977`*^9, 3.562350159450839*^9}, {
  3.562350404752123*^9, 3.56235042612569*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"name", "=", "\"\<sunAzimuth\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AbsoluteTiming", "[", 
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"repoDir", ",", "\"\<Tables\>\"", ",", 
            RowBox[{"name", "<>", "\"\<.csv\>\""}]}], "}"}], "]"}], ",", 
         RowBox[{"allTimeStep", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ";"}], "]"}], 
     "\[IndentingNewLine]", "name"}], "=", "\"\<sunAltitude\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Tables\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.csv\>\""}]}], "}"}], "]"}], ",", 
       RowBox[{"allTimeStep", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], ";"}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5615724599792843`*^9, 3.561572473895403*^9}, 
   3.562014037985899*^9, 3.5621494759375057`*^9, {3.562150645846932*^9, 
   3.562150646580858*^9}, {3.5627075330403547`*^9, 3.5627075474157467`*^9}, {
   3.562776321714107*^9, 3.5627763243187037`*^9}, {3.5628486407084923`*^9, 
   3.562848643001069*^9}, 3.562959466927949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute Azimuth/Altitude for Location ", \
"Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.5615719326120167`*^9, 3.5615719331289463`*^9}, {3.5617499879279737`*^9, 
  3.561749989944062*^9}, {3.562014244798807*^9, 3.562014262580276*^9}, {
  3.562350497900856*^9, 3.5623505152682467`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cityList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<North Pole\>\"", ",", "\"\<Artic Circle\>\"", ",", 
     "\"\<Reykjavik\>\"", ",", "\"\<Edinburgh\>\"", ",", "\"\<Paris\>\"", 
     ",", "\"\<Jerusalem\>\"", ",", "\"\<Bangkok\>\"", ",", 
     "\"\<Singapore\>\"", ",", "\"\<Rio\>\"", ",", "\"\<Sydney\>\"", ",", 
     "\"\<Ushuaia\>\"", ",", "\"\<Antartic Circle\>\"", ",", 
     "\"\<South Pole\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"earthOrbitalTilt", "=", 
   RowBox[{"1", "*", "23.45"}]}], "\[NoBreak]", 
  StyleBox["\[InvisibleSpace]",
   FontFamily->"Helvetica",
   FontSize->Smaller], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cityListSphereCoord", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"CityData", "[", 
       RowBox[{"#", ",", " ", "\"\<Coordinates\>\""}], "]"}], "&"}], ",", 
     "cityList"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cityListSphereCoord", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"90.0", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cityListSphereCoord", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"90.0", "-", "earthOrbitalTilt"}], ",", "0.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cityListSphereCoord", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Length", "[", "cityList", "]"}], "-", "1"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "90.0"}], "+", "earthOrbitalTilt"}], ",", "0.0"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cityListSphereCoord", "[", 
    RowBox[{"[", 
     RowBox[{"Length", "[", "cityList", "]"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "90.0"}], ",", "0.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"city", "=", 
   RowBox[{"cityList", "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"citySphereCoord", "=", 
   RowBox[{"cityListSphereCoord", "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cityLat", "=", 
   RowBox[{"citySphereCoord", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cityLong", "=", 
   RowBox[{"citySphereCoord", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{}], "\[IndentingNewLine]", "city", "\[IndentingNewLine]", "cityLat", \
"\[IndentingNewLine]", "cityLong", "\[IndentingNewLine]", 
 RowBox[{}], "\[IndentingNewLine]", 
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"sunAngleArray", "=", "sunAngleArrayCircular"}], ";"}], 
  "*)"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sunAngleArray", "=", 
   RowBox[{"sunAngleArrayElliptical", "-", "offsetSunAngleArray"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dayAngleArray", "=", 
   RowBox[{"dayAngleArrayLongZero", "-", "cityLong"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.562523713991029*^9, 3.562523766999384*^9}, {
   3.562523800530109*^9, 3.562523844528459*^9}, {3.562523904120658*^9, 
   3.562523913513009*^9}, {3.562607713796598*^9, 3.562607726615549*^9}, {
   3.562695050271182*^9, 3.5626950553491697`*^9}, {3.562776722260953*^9, 
   3.562776771315956*^9}, {3.562777071667151*^9, 3.562777104665677*^9}, {
   3.562777149775724*^9, 3.562777151223441*^9}, 3.5627771859468803`*^9, {
   3.562777228995109*^9, 3.562777235344948*^9}, {3.562777320571516*^9, 
   3.562777331169786*^9}, {3.5627773661486387`*^9, 3.5627774144347754`*^9}, {
   3.56277746765898*^9, 3.562777480947392*^9}, {3.562777621544249*^9, 
   3.562777695792007*^9}, {3.562777726515691*^9, 3.562777792855714*^9}, 
   3.562777836290659*^9, {3.56277789064028*^9, 3.562777982473773*^9}, {
   3.5627780219639273`*^9, 3.562778047826297*^9}, {3.562778552176095*^9, 
   3.5627785526333237`*^9}, {3.562778668371071*^9, 3.562778681592743*^9}, {
   3.562778813649934*^9, 3.5627788530369368`*^9}, {3.562778885931794*^9, 
   3.562778892274788*^9}, {3.562778943562974*^9, 3.562779110662953*^9}, {
   3.562779141488703*^9, 3.5627791870311193`*^9}, {3.562779259249192*^9, 
   3.562779259999897*^9}, {3.562779308401823*^9, 3.562779318780608*^9}, {
   3.56277942384995*^9, 3.562779433014886*^9}, {3.562779477861985*^9, 
   3.562779529506921*^9}, {3.562779563213437*^9, 3.5627795641034184`*^9}, 
   3.562779936086852*^9, 3.562780046050538*^9, 3.562780123577175*^9, {
   3.562780654358094*^9, 3.5627806548194532`*^9}, 3.5627812309234*^9, 
   3.562781408231707*^9, {3.562781796288623*^9, 3.562781819388397*^9}, 
   3.5627818759700823`*^9, {3.562781981538192*^9, 3.562782003962947*^9}, 
   3.562782037670044*^9, {3.562782170102161*^9, 3.5627821703758802`*^9}, {
   3.562782593817748*^9, 3.562782593948552*^9}, {3.562782693564382*^9, 
   3.562782703149477*^9}, {3.562782746208684*^9, 3.562782746671238*^9}, {
   3.562782834386746*^9, 3.56278283861917*^9}, {3.56278293417126*^9, 
   3.562782934655691*^9}, {3.562783039300477*^9, 3.562783039784984*^9}, {
   3.562783336387898*^9, 3.562783357775195*^9}, {3.562783428948069*^9, 
   3.5627834410293083`*^9}, {3.562783611227109*^9, 3.562783613033897*^9}, {
   3.562783660966044*^9, 3.5627836618025093`*^9}, {3.562783802108924*^9, 
   3.562783806935027*^9}, {3.562787618699716*^9, 3.562787619006969*^9}, {
   3.5627879090005608`*^9, 3.562787910596936*^9}, {3.5627882308711767`*^9, 
   3.562788257770423*^9}, {3.562788452336314*^9, 3.562788452804345*^9}, 
   3.5627892209676857`*^9, 3.562789333314191*^9, {3.5627896800282793`*^9, 
   3.562789680416082*^9}, 3.562835310085441*^9, {3.562840749998348*^9, 
   3.56284075201343*^9}, {3.5628434834564457`*^9, 3.5628434892473707`*^9}, 
   3.562844094854011*^9, {3.562844154484419*^9, 3.562844155982832*^9}, {
   3.562844723308896*^9, 3.5628447336439247`*^9}, {3.562844994383464*^9, 
   3.562844994885809*^9}, {3.562845232865699*^9, 3.562845233392489*^9}, {
   3.562847598808069*^9, 3.562847599110688*^9}, 3.5628485153695507`*^9, {
   3.56284859765147*^9, 3.5628485981722*^9}, 3.562857154876688*^9, {
   3.562857400982884*^9, 3.562857408615162*^9}, {3.562857881587576*^9, 
   3.562857886435411*^9}, 3.562857976780704*^9, 3.562858093365617*^9, 
   3.562858189966276*^9, {3.562858269023307*^9, 3.562858269179556*^9}, 
   3.562858394720283*^9, 3.562858471689139*^9, 3.5628585344336443`*^9, 
   3.5628600839210987`*^9, {3.562860454467217*^9, 3.562860471803225*^9}, {
   3.562860512307889*^9, 3.562860517022039*^9}, 3.562954407532691*^9, {
   3.5629571172866096`*^9, 3.562957129805401*^9}, {3.5629574847380533`*^9, 
   3.56295749369239*^9}, {3.5629575739767036`*^9, 3.56295757606712*^9}, {
   3.562957924520809*^9, 3.562957969327808*^9}, {3.562958618988551*^9, 
   3.5629586239230223`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"earthRadius", "=", "1.0"}], 
  RowBox[{"(*", "6367.5", "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sphericalToCartesian", "[", 
    RowBox[{"{", 
     RowBox[{"lat_", ",", "lon_"}], "}"}], "]"}], ":=", 
   RowBox[{"earthRadius", "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"lon", " ", "\[Degree]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"lon", " ", "\[Degree]"}], "]"}]}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cityCartCoord", "=", 
   RowBox[{"sphericalToCartesian", "[", "citySphereCoord", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotTilt", "=", 
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{"earthOrbitalTilt", " ", 
      StyleBox["\[Degree]",
       FontFamily->"Helvetica",
       FontSize->Smaller]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotSunAxis", "=", 
   RowBox[{"rotTilt", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotLat", "=", 
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"citySphereCoord", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Degree]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotLong", "=", 
   RowBox[{"RotationTransform", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"citySphereCoord", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Degree]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toNorthInit", "=", 
   RowBox[{"rotLong", "[", 
    RowBox[{"rotLat", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toEastInit", "=", 
   RowBox[{"rotLong", "[", 
    RowBox[{"rotLat", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toZenithInit", "=", 
    RowBox[{"rotLong", "[", 
     RowBox[{"rotLat", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resultAnalemma", "[", "h_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dateTime", ",", "timeStep", ",", "dayAngle", ",", "sunAngle", ",", 
        "rotDay", ",", "rotSun", ",", "toSunVector", ",", "rotCityCartCoord", 
        ",", "toZenithVector", ",", "toNorthVector", ",", "toEastVector", ",",
         "toSunHorizontalVector", ",", "sunAzimuth", ",", "sunAltitude"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"dateTime", "=", 
          RowBox[{
           RowBox[{"DatePlus", "[", 
            RowBox[{"startDateTime", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"d", "-", "1"}], ",", "\"\<Day\>\""}], "}"}]}], "]"}], 
           "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "h", ",", "0", ",", "0"}], 
            "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"timeStep", "=", 
          RowBox[{"datetimeToTimestep", "[", "dateTime", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"timeStep", "=", 
          RowBox[{"1", "-", "offsetNbTimeStep", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "-", "1"}], ")"}], "*", "timeStepPerDay"}], "+", 
           RowBox[{"h", "*", "timeStepPerHour"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dayAngle", "=", 
          RowBox[{"dayAngleArray", "[", 
           RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAngle", "=", 
          RowBox[{"sunAngleArray", "[", 
           RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotDay", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"dayAngle", " ", "\[Degree]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotSun", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"sunAngle", " ", "\[Degree]"}], ",", "rotSunAxis"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"toSunVector", "=", 
          RowBox[{"rotSun", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotCityCartCoord", "=", 
          RowBox[{"rotDay", "[", "cityCartCoord", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toZenithVector", "=", 
          RowBox[{"rotDay", "[", "toZenithInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toNorthVector", "=", 
          RowBox[{"rotDay", "[", "toNorthInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toEastVector", "=", 
          RowBox[{"rotDay", "[", "toEastInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toSunHorizontalVector", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"toNorthVector", ".", "toSunVector"}], ")"}], 
            "toNorthVector"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"toEastVector", ".", "toSunVector"}], ")"}], 
            "toEastVector"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sunAzimuth", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"VectorAngle", "[", 
              RowBox[{"toNorthVector", ",", "toSunHorizontalVector"}], "]"}], 
             "*", 
             RowBox[{"360", "/", 
              RowBox[{"(", 
               RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAzimuth", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"toEastVector", ".", "toSunVector"}], ">", "0"}], ",", 
            "sunAzimuth", ",", 
            RowBox[{"360.0", "-", "sunAzimuth"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAltitude", "=", 
          RowBox[{"90.0", "-", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"VectorAngle", "[", 
              RowBox[{"toZenithVector", ",", "toSunVector"}], "]"}], "*", 
             RowBox[{"360", "/", 
              RowBox[{"(", 
               RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<datetime=\>\"", ",", "dateTime"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<timeStep=\>\"", ",", "timeStep"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<dayAngle=\>\"", ",", "dayAngle"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<sunAngle=\>\"", ",", "sunAngle"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<toSun=\>\"", ",", "toSunVector"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<rotCityCartCoord=\>\"", ",", "rotCityCartCoord"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<toZenithVector=\>\"", ",", "toZenithVector"}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<toNorthVector=\>\"", ",", "toNorthVector"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<toEastVector=\>\"", ",", "toEastVector"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<toSunHorizontalVector=\>\"", ",", "toSunHorizontalVector"}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<sunAzimuth=\>\"", ",", "sunAzimuth"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<sunAltitude=\>\"", ",", "sunAltitude"}], "]"}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sunAzimuth", ",", "sunAltitude"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "365"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resultDay", "[", 
     RowBox[{"day_", ",", "step_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dayAngle", ",", "sunAngle", ",", "rotDay", ",", "rotSun", ",", 
        "toSunVector", ",", "rotCityCartCoord", ",", "toZenithVector", ",", 
        "toNorthVector", ",", "toEastVector", ",", "toSunHorizontalVector", 
        ",", "sunAzimuth", ",", "sunAltitude"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"dayAngle", "=", 
          RowBox[{"dayAngleArray", "[", 
           RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAngle", "=", 
          RowBox[{"sunAngleArray", "[", 
           RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotDay", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"dayAngle", " ", "\[Degree]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotSun", "=", 
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"sunAngle", " ", "\[Degree]"}], ",", "rotSunAxis"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"toSunVector", "=", 
          RowBox[{"rotSun", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rotCityCartCoord", "=", 
          RowBox[{"rotDay", "[", "cityCartCoord", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toZenithVector", "=", 
          RowBox[{"rotDay", "[", "toZenithInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toNorthVector", "=", 
          RowBox[{"rotDay", "[", "toNorthInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toEastVector", "=", 
          RowBox[{"rotDay", "[", "toEastInit", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toSunHorizontalVector", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"toNorthVector", ".", "toSunVector"}], ")"}], 
            "toNorthVector"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"toEastVector", ".", "toSunVector"}], ")"}], 
            "toEastVector"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sunAzimuth", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"VectorAngle", "[", 
             RowBox[{"toNorthVector", ",", "toSunHorizontalVector"}], "]"}], 
            "*", 
            RowBox[{"360", "/", 
             RowBox[{"(", 
              RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAzimuth", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"toEastVector", ".", "toSunVector"}], ">", "0"}], ",", 
            "sunAzimuth", ",", 
            RowBox[{"360.0", "-", "sunAzimuth"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sunAltitude", "=", 
          RowBox[{"90.0", "-", 
           RowBox[{"Re", "@", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"VectorAngle", "[", 
               RowBox[{"toZenithVector", ",", "toSunVector"}], "]"}], "*", 
              RowBox[{"360", "/", 
               RowBox[{"(", 
                RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sunAzimuth", ",", "sunAltitude"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"timeStep", ",", 
          RowBox[{"1", "-", "offsetNbTimeStep", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"day", "-", "1"}], ")"}], "*", "timeStepPerDay"}]}], ",", 
          RowBox[{"1", "-", "offsetNbTimeStep", "+", 
           RowBox[{"day", "*", "timeStepPerDay"}]}], ",", "step"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resultAll", "[", "timeStep_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dayAngle", ",", "sunAngle", ",", "rotDay", ",", "rotSun", ",", 
        "toSunVector", ",", "rotCityCartCoord", ",", "toZenithVector", ",", 
        "toNorthVector", ",", "toEastVector", ",", "toSunHorizontalVector", 
        ",", "sunAzimuth", ",", "sunAltitude"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dayAngle", "=", 
        RowBox[{"dayAngleArray", "[", 
         RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"sunAngle", "=", 
        RowBox[{"sunAngleArray", "[", 
         RowBox[{"[", "timeStep", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"rotDay", "=", 
        RowBox[{"RotationTransform", "[", 
         RowBox[{
          RowBox[{"dayAngle", " ", "\[Degree]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotSun", "=", 
        RowBox[{"RotationTransform", "[", 
         RowBox[{
          RowBox[{"sunAngle", " ", "\[Degree]"}], ",", "rotSunAxis"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"toSunVector", "=", 
        RowBox[{"rotSun", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotCityCartCoord", "=", 
        RowBox[{"rotDay", "[", "cityCartCoord", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toZenithVector", "=", 
        RowBox[{"rotDay", "[", "toZenithInit", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toNorthVector", "=", 
        RowBox[{"rotDay", "[", "toNorthInit", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toEastVector", "=", 
        RowBox[{"rotDay", "[", "toEastInit", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toSunHorizontalVector", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"toNorthVector", ".", "toSunVector"}], ")"}], 
          "toNorthVector"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"toEastVector", ".", "toSunVector"}], ")"}], 
          "toEastVector"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sunAzimuth", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"VectorAngle", "[", 
           RowBox[{"toNorthVector", ",", "toSunHorizontalVector"}], "]"}], 
          "*", 
          RowBox[{"360", "/", 
           RowBox[{"(", 
            RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sunAzimuth", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"toEastVector", ".", "toSunVector"}], ">", "0"}], ",", 
          "sunAzimuth", ",", 
          RowBox[{"360.0", "-", "sunAzimuth"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sunAltitude", "=", 
        RowBox[{"90.0", "-", 
         RowBox[{"Re", "@", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"VectorAngle", "[", 
             RowBox[{"toZenithVector", ",", "toSunVector"}], "]"}], "*", 
            RowBox[{"360", "/", 
             RowBox[{"(", 
              RowBox[{"2", "Pi"}], ")"}]}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"sunAzimuth", ",", "sunAltitude"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datetimeToDaynb", "[", "datetime_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "d", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"DateDifference", "[", 
        RowBox[{"startDateTime", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"datetime", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"datetime", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"datetime", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", "\"\<Day\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"1", "+", 
       RowBox[{"d", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.561746750831798*^9, 3.561746836300376*^9}, {
   3.561746962899105*^9, 3.561747210390465*^9}, {3.5617472466168337`*^9, 
   3.56174725580512*^9}, {3.5617498493427773`*^9, 3.561749851621499*^9}, {
   3.561749945466687*^9, 3.561749968862566*^9}, {3.561833928495214*^9, 
   3.5618339589302063`*^9}, {3.5618375104976482`*^9, 3.561837547369844*^9}, 
   3.561837653505376*^9, 3.561917160414441*^9, {3.561917265357814*^9, 
   3.56191727615049*^9}, {3.561917340558626*^9, 3.561917351550579*^9}, 
   3.561917393815184*^9, {3.561931362171431*^9, 3.561931362609202*^9}, 
   3.561931394568166*^9, {3.5620142918366117`*^9, 3.562014299331456*^9}, {
   3.5620143441894703`*^9, 3.5620143946367283`*^9}, 3.562014450244981*^9, {
   3.562014675221849*^9, 3.562014693834093*^9}, 3.5620148768598843`*^9, {
   3.562014923601452*^9, 3.562014940985937*^9}, {3.562015039857692*^9, 
   3.562015053515473*^9}, {3.562015185261438*^9, 3.562015185354418*^9}, {
   3.562015246611401*^9, 3.5620152791241302`*^9}, {3.562015536544022*^9, 
   3.562015713253098*^9}, {3.562016389490775*^9, 3.5620164211787443`*^9}, {
   3.562016472243266*^9, 3.562016473610003*^9}, {3.562017513371986*^9, 
   3.5620175573827257`*^9}, {3.5620176026280613`*^9, 3.562017624711916*^9}, {
   3.562017670711434*^9, 3.562017674455949*^9}, {3.562017717272595*^9, 
   3.562017718999681*^9}, {3.562098455874144*^9, 3.562098457282337*^9}, 
   3.562107880721683*^9, {3.562140596126637*^9, 3.562140631226026*^9}, {
   3.562149097201597*^9, 3.56214911694694*^9}, {3.562149333194352*^9, 
   3.562149342398614*^9}, {3.562149463722361*^9, 3.562149466802958*^9}, 
   3.562149518958468*^9, {3.562149648470495*^9, 3.562149652567235*^9}, {
   3.5621499681064367`*^9, 3.5621499698473997`*^9}, {3.562150553762233*^9, 
   3.562150555935223*^9}, {3.562151292545188*^9, 3.562151363665021*^9}, {
   3.562151597062183*^9, 3.562151599026832*^9}, {3.562151690474642*^9, 
   3.562151693717154*^9}, {3.562151828543521*^9, 3.562151828729228*^9}, {
   3.562151911343933*^9, 3.5621519432273197`*^9}, {3.5621522174226313`*^9, 
   3.562152218693779*^9}, {3.5621530558260937`*^9, 3.562153071863288*^9}, {
   3.5621680110246763`*^9, 3.562168030173459*^9}, 3.5621681933916883`*^9, 
   3.562180111059264*^9, {3.5621812036427*^9, 3.562181243682384*^9}, {
   3.562181300000985*^9, 3.562181308120263*^9}, {3.5621813417176113`*^9, 
   3.562181374293646*^9}, {3.562181421104034*^9, 3.562181518449833*^9}, {
   3.5621815588024817`*^9, 3.562181624059626*^9}, {3.5621816861588573`*^9, 
   3.562181694949835*^9}, 3.56218174271194*^9, {3.562181924691144*^9, 
   3.562181926485572*^9}, {3.562182088144627*^9, 3.562182088520643*^9}, {
   3.562182192749989*^9, 3.562182211278761*^9}, {3.562182256512876*^9, 
   3.562182311712903*^9}, {3.56218247307342*^9, 3.562182473253022*^9}, 
   3.562182604429823*^9, {3.562183158052096*^9, 3.562183166892745*^9}, {
   3.562183197303512*^9, 3.562183250101026*^9}, {3.562183466106278*^9, 
   3.562183489331761*^9}, {3.5621836441343403`*^9, 3.56218364601285*^9}, {
   3.5621836859189053`*^9, 3.5621837333954773`*^9}, {3.5621840636198883`*^9, 
   3.562184065947135*^9}, {3.5621841004038754`*^9, 3.562184115856688*^9}, 
   3.562184145892173*^9, 3.5621842186432056`*^9, {3.5621843203088083`*^9, 
   3.5621843266673517`*^9}, {3.562184743657317*^9, 3.562184793456025*^9}, {
   3.562186818832684*^9, 3.5621868333847857`*^9}, {3.562186892333211*^9, 
   3.5621869316056232`*^9}, {3.5621869811680603`*^9, 3.5621870356174803`*^9}, 
   3.562187540460187*^9, {3.562187570475975*^9, 3.562187598428585*^9}, {
   3.562187648695037*^9, 3.562187653541389*^9}, {3.562187701257948*^9, 
   3.562187702664406*^9}, 3.562229803905911*^9, {3.5622541532269*^9, 
   3.562254154889853*^9}, {3.562254261388701*^9, 3.562254349221405*^9}, {
   3.562254429348711*^9, 3.5622544349336967`*^9}, {3.562254515814516*^9, 
   3.562254520957211*^9}, {3.562261806110491*^9, 3.5622618141284437`*^9}, {
   3.562264310835484*^9, 3.5622643112702837`*^9}, {3.562265626504634*^9, 
   3.562265659578726*^9}, {3.562266101559058*^9, 3.562266107541202*^9}, {
   3.562266189707122*^9, 3.562266254840081*^9}, {3.562266302466579*^9, 
   3.562266401318338*^9}, {3.562266460659678*^9, 3.5622664614144287`*^9}, {
   3.562266578619487*^9, 3.562266579105817*^9}, {3.56226666379492*^9, 
   3.562266707935031*^9}, {3.562267292986061*^9, 3.562267295538464*^9}, {
   3.56226735617038*^9, 3.5622673563088503`*^9}, 3.5622675092087603`*^9, {
   3.562267611458432*^9, 3.5622676120445957`*^9}, 3.5622676511132517`*^9, {
   3.562268287104722*^9, 3.562268290056019*^9}, {3.562268433476955*^9, 
   3.5622684678222227`*^9}, 3.562268508029907*^9, {3.562268655437409*^9, 
   3.562268657515176*^9}, 3.562271014987411*^9, {3.562272339463812*^9, 
   3.562272339864645*^9}, 3.562272804186851*^9, 3.5623467283744707`*^9, 
   3.562347143169036*^9, {3.562347400925462*^9, 3.562347403061729*^9}, {
   3.5623504810191393`*^9, 3.5623504815499477`*^9}, {3.562350806974575*^9, 
   3.56235082624048*^9}, {3.562352136665743*^9, 3.5623521373274593`*^9}, 
   3.562521604941152*^9, {3.5625216411107616`*^9, 3.562521652357236*^9}, {
   3.562521687978669*^9, 3.562521688486105*^9}, {3.562521898717842*^9, 
   3.562521910684534*^9}, 3.562522368644021*^9, {3.562522736933508*^9, 
   3.56252275308585*^9}, {3.562523315984518*^9, 3.562523318208823*^9}, {
   3.5625236579957647`*^9, 3.562523662485948*^9}, 3.562523703146799*^9, {
   3.562523816134411*^9, 3.562523817173234*^9}, 3.562523901802718*^9, {
   3.562695551678858*^9, 3.562695552141993*^9}, {3.562696382372377*^9, 
   3.5626963829831343`*^9}, {3.562703543820661*^9, 3.562703555998012*^9}, {
   3.562703780292713*^9, 3.562703803998715*^9}, {3.562703837193664*^9, 
   3.562703862910845*^9}, 3.562778999558824*^9, {3.562787677775181*^9, 
   3.562787680965797*^9}, {3.562787858702455*^9, 3.562787901521729*^9}, {
   3.562788093981855*^9, 3.5627881519362698`*^9}, 3.562788185459867*^9, {
   3.562840743516613*^9, 3.5628407438149757`*^9}, {3.562862921597642*^9, 
   3.56286293098621*^9}, 3.562863029713872*^9, {3.5629594828521748`*^9, 
   3.562959483577178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allPath", "=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "allDate", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allDate", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"DatePlus", "[", 
            RowBox[{"startDateTime", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "\"\<Month\>\""}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "12"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"resultDay", "[", 
           RowBox[{
            RowBox[{"datetimeToDaynb", "[", 
             RowBox[{"allDate", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "12"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"allAnalemma", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"resultAnalemma", "[", 
        RowBox[{"h", "-", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "24"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5620165892573767`*^9, 3.5620166044835*^9}, {
   3.562016637253666*^9, 3.5620166378278627`*^9}, {3.562016990432629*^9, 
   3.562017030023785*^9}, {3.562017788314191*^9, 3.562017812183549*^9}, {
   3.562093508849824*^9, 3.56209351438431*^9}, {3.562093900800852*^9, 
   3.562094061299399*^9}, {3.5620941066362667`*^9, 3.5620941564906282`*^9}, {
   3.562098474527087*^9, 3.562098487802896*^9}, {3.562107890070078*^9, 
   3.562107891443748*^9}, {3.5622529193681793`*^9, 3.562252949383308*^9}, {
   3.562261833270528*^9, 3.562261836092046*^9}, {3.562521819506332*^9, 
   3.5625218269838657`*^9}, {3.562522484492771*^9, 3.562522486661089*^9}, {
   3.562524090821114*^9, 3.5625240940597467`*^9}, 3.5625249208678713`*^9, {
   3.562524958653421*^9, 3.5625250242685623`*^9}, {3.562525082015552*^9, 
   3.5625251549502363`*^9}, {3.562525369049539*^9, 3.5625253786001673`*^9}, {
   3.562525427217914*^9, 3.562525436755272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allTimeStep", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"resultAll", "[", "ts", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ts", ",", "nbTimeStep"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5627039167853193`*^9, 3.562703951720957*^9}, {
   3.5627040557470837`*^9, 3.56270412876318*^9}, {3.5627073666422787`*^9, 
   3.5627073705057783`*^9}, 3.56284870093152*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Plot", "Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.5615719326120167`*^9, 3.5615719331289463`*^9}, {3.5617499879279737`*^9, 
  3.561749989944062*^9}, {3.562014244798807*^9, 3.562014262580276*^9}, {
  3.562015306710223*^9, 3.562015307238564*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"listPlotAnalemma", "[", "h_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "point", ",", "allPointDate", ",", "dateName", ",", "allAnalemma"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allAnalemma", "=", 
       RowBox[{"resultAnalemma", "[", "h", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allPointDate", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"DateDifference", "[", 
            RowBox[{"startDateTime", ",", 
             RowBox[{"DatePlus", "[", 
              RowBox[{"startDateTime", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "\"\<Month\>\""}], "}"}]}], 
              "]"}], ",", "\"\<Day\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dateName", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<20 \>\"", "<>", "#"}], ")"}], "&"}], ",", 
         RowBox[{"RotateLeft", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"DateString", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "n"}], "}"}], ",", 
               RowBox[{"{", "\"\<MonthNameShort\>\"", "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "12"}], "}"}]}], "]"}], ",", "2"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"point", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"allAnalemma", "[", 
          RowBox[{"[", 
           RowBox[{"allPointDate", "[", 
            RowBox[{"[", "m", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Tooltip", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"w", ",", 
               RowBox[{"90", "-", "cityLat"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"w", ",", "177", ",", "183", ",", "0.01"}], "}"}]}], 
            "]"}], ",", "allAnalemma"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"AxesOrigin", "\[Rule]", "Automatic"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"h", "\[Equal]", "12"}], ",", 
             RowBox[{"180", "*", "1"}], ",", "Automatic"}], "]"}], ",", 
           RowBox[{"1", "*", 
            RowBox[{"(", 
             RowBox[{"90", "-", "cityLat"}], ")"}]}]}], "}"}]}], ",", " ", 
        RowBox[{"(*", "northhemisphere", "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"h", "\[Equal]", "12"}], ",", 
               RowBox[{"180", "*", "0"}], ",", "Automatic"}], "]"}], ",", 
             RowBox[{"1", "*", 
              RowBox[{"(", 
               RowBox[{"90", "-", "cityLat"}], ")"}]}]}], "}"}]}], ","}], " ", 
         RowBox[{"(*", "southhemisphere", "*)"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.0", "]"}], ",", "Green"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", 
             RowBox[{"Lighter", "[", 
              RowBox[{"Blue", ",", "0.4"}], "]"}], ",", 
             RowBox[{"PointSize", "[", "Small", "]"}]}], "}"}]}], "}"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "360"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"90", "-", 
                RowBox[{"Abs", "[", "cityLat", "]"}], "-", "earthOrbitalTilt",
                 "-", "5"}], ",", "90"}], "}"}]}], "}"}]}], ","}], " ", 
         RowBox[{"(*", 
          RowBox[{"between", " ", "tropics"}], "*)"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "90", "-", "cityLat", "-", "earthOrbitalTilt", "-", "5"}], ",", 
             RowBox[{
             "90", "-", "cityLat", "+", "earthOrbitalTilt", "+", "5"}]}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"(*", "northemisphere", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "90", "-", "cityLat", "+", "earthOrbitalTilt", "+", "5"}], ",", 
               RowBox[{
               "90", "-", "cityLat", "-", "earthOrbitalTilt", "-", "5"}]}], 
              "}"}]}], "}"}]}], ","}], 
         RowBox[{"(*", "southhemisphere", "*)"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "@", 
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", "13"}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Azimuth\>\"", ",", "\"\<Altitude\>\""}], "}"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<Analemma \>\"", "<>", 
             RowBox[{"ToString", "[", "h", "]"}], "<>", "\"\<:00\\n\>\"", "<>",
              "city", "<>", "\"\<\\nLat = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"cityLat", ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
             "\"\<\[Degree]   Long = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{"cityLong", ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
             "\"\<\[Degree]\\n\>\""}], ",", "Bold", ",", "14", ",", 
            RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "0.01", "]"}], ",", "Red", ",", 
             RowBox[{"Point", "[", "point", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Text", "@", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "10", ",", "Italic", 
                   ",", "Black"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", 
                   RowBox[{"0.5", "*", "0"}]}], "}"}]}]}], "]"}], ")"}], 
             "&"}], " ", "/@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dateName", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"point", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "point", "]"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"output", "=", 
  RowBox[{
  "listPlotAnalemma", "[", "12", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5617472610807753`*^9, 3.561747294577178*^9}, 
   3.561747442243787*^9, {3.5617502024758863`*^9, 3.561750335110873*^9}, {
   3.561750376753068*^9, 3.5617504170799932`*^9}, {3.561750465136039*^9, 
   3.561750485152338*^9}, {3.5617505544344254`*^9, 3.561750558049666*^9}, {
   3.5617505898816833`*^9, 3.561750651234385*^9}, {3.561754942211714*^9, 
   3.561754953562747*^9}, {3.561832626649685*^9, 3.561832626729664*^9}, {
   3.561832822684402*^9, 3.561832831187339*^9}, {3.5618340018635*^9, 
   3.561834002206893*^9}, {3.5618353102333593`*^9, 3.561835350811582*^9}, {
   3.561835407011594*^9, 3.561835418852139*^9}, {3.561835494012542*^9, 
   3.561835547675748*^9}, {3.5618356076778584`*^9, 3.561835611016156*^9}, {
   3.561835803921854*^9, 3.561835806952385*^9}, {3.561836330251005*^9, 
   3.561836381005828*^9}, {3.561836416983355*^9, 3.5618364197888927`*^9}, {
   3.5618364765928307`*^9, 3.561836480919862*^9}, {3.561836670456904*^9, 
   3.56183667401641*^9}, {3.561837576160839*^9, 3.561837576361067*^9}, 
   3.561837715110783*^9, {3.5618378720286493`*^9, 3.561837876851863*^9}, {
   3.561838073309635*^9, 3.561838104310004*^9}, {3.561838208008122*^9, 
   3.561838208327166*^9}, {3.5618383383854303`*^9, 3.5618383389838963`*^9}, 
   3.561917403198069*^9, {3.561917769042613*^9, 3.5619177693777027`*^9}, 
   3.56201464429226*^9, 3.562016357387936*^9, 3.562016585252398*^9, 
   3.562016985821303*^9, 3.5621079234143476`*^9, {3.562149048645484*^9, 
   3.562149048759597*^9}, {3.5621491517269173`*^9, 3.5621491543210783`*^9}, {
   3.5621502404577827`*^9, 3.562150252122999*^9}, {3.5621502873944473`*^9, 
   3.562150317627877*^9}, {3.562150348277095*^9, 3.5621504348133717`*^9}, {
   3.562150485091992*^9, 3.562150516582082*^9}, {3.5621515191636677`*^9, 
   3.5621515515877123`*^9}, 3.562168381308671*^9, 3.562168438746509*^9, {
   3.562182146623105*^9, 3.562182158941703*^9}, {3.562183842885189*^9, 
   3.5621838430038223`*^9}, {3.562186514124667*^9, 3.5621865258252707`*^9}, {
   3.562187850858101*^9, 3.562187857930318*^9}, {3.5622579140145283`*^9, 
   3.562257992231968*^9}, {3.56225803459226*^9, 3.5622580415362387`*^9}, {
   3.562258139153061*^9, 3.5622582455708714`*^9}, 3.5622583080541267`*^9, {
   3.56225834479676*^9, 3.562258416761516*^9}, {3.562258561742796*^9, 
   3.5622588034982157`*^9}, {3.56225883815694*^9, 3.5622588500590067`*^9}, {
   3.562259133783476*^9, 3.56225915087066*^9}, {3.562259210691094*^9, 
   3.562259216376904*^9}, {3.562259331377102*^9, 3.562259380839608*^9}, 
   3.562259601114373*^9, {3.5622596802666473`*^9, 3.5622597064191713`*^9}, {
   3.5622645253700657`*^9, 3.562264536897443*^9}, {3.562264951474619*^9, 
   3.562264959893062*^9}, {3.562265429110381*^9, 3.5622654442793617`*^9}, {
   3.5622654821869392`*^9, 3.562265511315292*^9}, {3.562265548700338*^9, 
   3.562265560279479*^9}, {3.562266633661508*^9, 3.5622666459089813`*^9}, 
   3.562270814661619*^9, {3.562271021342411*^9, 3.562271047731494*^9}, {
   3.562271902505698*^9, 3.5622719030883083`*^9}, {3.562272676775795*^9, 
   3.56227272510478*^9}, {3.562347884494336*^9, 3.562347886818295*^9}, {
   3.5623507019665823`*^9, 3.562350758204994*^9}, {3.56235084506201*^9, 
   3.562350846750009*^9}, {3.562350899817181*^9, 3.5623509452550793`*^9}, {
   3.562351043337521*^9, 3.562351063584053*^9}, {3.562351147497121*^9, 
   3.562351199779476*^9}, {3.562351272992063*^9, 3.562351399174673*^9}, {
   3.56235149738487*^9, 3.562351511775468*^9}, {3.562351545299759*^9, 
   3.562351664313714*^9}, {3.5623517094999323`*^9, 3.5623517985950947`*^9}, {
   3.562351835837866*^9, 3.562351836435738*^9}, {3.562351877141614*^9, 
   3.562351972597466*^9}, {3.5623520068789682`*^9, 3.562352123278657*^9}, {
   3.562352161537773*^9, 3.562352214111689*^9}, {3.562352252057437*^9, 
   3.562352324392481*^9}, {3.5623523604332848`*^9, 3.562352534899117*^9}, {
   3.562352566542544*^9, 3.562352851718176*^9}, {3.562352898319714*^9, 
   3.562352909519702*^9}, {3.562521781957218*^9, 3.5625218106031857`*^9}, {
   3.562521989792749*^9, 3.562522062299452*^9}, {3.562522255639502*^9, 
   3.562522277911214*^9}, {3.5625223098741817`*^9, 3.562522318864142*^9}, 
   3.5625225388138323`*^9, {3.562522613047555*^9, 3.562522621782956*^9}, 
   3.562522698687799*^9, {3.562523347801928*^9, 3.56252337663349*^9}, {
   3.5625234632634573`*^9, 3.5625234903749533`*^9}, {3.56252396193174*^9, 
   3.562523972947755*^9}, {3.562776350444141*^9, 3.562776352001854*^9}, 
   3.562776659078876*^9, {3.562779710799882*^9, 3.562779745258391*^9}, 
   3.562779778000967*^9, 3.562779821468891*^9, {3.5627798927893133`*^9, 
   3.562779913395618*^9}, {3.562780349977646*^9, 3.562780350507444*^9}, {
   3.5627806002925787`*^9, 3.5627806007620583`*^9}, {3.562780797532258*^9, 
   3.562780889900935*^9}, {3.5627809299367533`*^9, 3.5627809376780643`*^9}, {
   3.562781034870116*^9, 3.562781189528297*^9}, {3.562781447165141*^9, 
   3.56278148170778*^9}, {3.56278252957271*^9, 3.562782537022332*^9}, {
   3.562782794626896*^9, 3.56278280192168*^9}, {3.562782860428029*^9, 
   3.56278286309805*^9}, 3.562782987223433*^9, {3.562783061372796*^9, 
   3.562783067862121*^9}, {3.562788415278089*^9, 3.562788417036656*^9}, {
   3.56278859819145*^9, 3.562788613872387*^9}, {3.562788724595994*^9, 
   3.562788756977756*^9}, {3.562789083872365*^9, 3.562789129581238*^9}, {
   3.562789174182423*^9, 3.56278917427771*^9}, {3.562789241127018*^9, 
   3.5627893153411627`*^9}, {3.562789357610976*^9, 3.562789447993877*^9}, {
   3.56278950089051*^9, 3.562789516432002*^9}, {3.562789553750301*^9, 
   3.562789595287293*^9}, {3.562789650500296*^9, 3.562789653796157*^9}, {
   3.562789698500513*^9, 3.56278973010105*^9}, {3.5628353287899303`*^9, 
   3.5628353446909637`*^9}, 3.5628363505350246`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"\"\<picAnalemma\>\"", "<>", "city"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
        RowBox[{"name", "<>", "\"\<.png\>\""}]}], "}"}], "]"}], ",", "output",
      ",", "\"\<PNG\>\"", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ";"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.562779690368821*^9, 3.562779706498846*^9}, {
  3.562779831888775*^9, 3.5627798503047857`*^9}, {3.562779949290093*^9, 
  3.5627799558575068`*^9}, {3.562781513706149*^9, 3.562781515417033*^9}}],

Cell[BoxData[
 RowBox[{"90", "-", 
  RowBox[{"(", 
   RowBox[{"13.73", "+", "23.45"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.562789157451318*^9, 3.562789169632923*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Pisces\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<TauPiscium\>\"", ",", "\"\<UpsilonPiscium\>\"", ",", 
      "\"\<PhiPiscium\>\"", ",", "\"\<EtaPiscium\>\"", ",", 
      "\"\<OmicronPiscium\>\"", ",", "\"\<AlphaPiscium\>\"", ",", 
      "\"\<NuPiscium\>\"", ",", "\"\<MuPiscium\>\"", ",", 
      "\"\<EpsilonPiscium\>\"", ",", "\"\<DeltaPiscium\>\"", ",", 
      "\"\<OmegaPiscium\>\"", ",", "\"\<IotaPiscium\>\"", ",", 
      "\"\<ThetaPiscium\>\"", ",", "\"\<HIP115227\>\"", ",", 
      "\"\<GammaPiscium\>\"", ",", "\"\<KappaPiscium\>\"", ",", 
      "\"\<LambdaPiscium\>\"", ",", "\"\<HIP117245\>\"", ",", 
      "\"\<IotaPiscium\>\""}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Gemini\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<XiGeminorum\>\"", ",", "\"\<Alhena\>\"", ",", "\"\<Mekbuda\>\"", 
      ",", "\"\<Wasat\>\"", ",", "\"\<KappaGeminorum\>\"", ",", 
      "\"\<Pollux\>\"", ",", "\"\<Castor\>\"", ",", "\"\<RhoGeminorum\>\"", 
      ",", "\"\<TauGeminorum\>\"", ",", "\"\<Mebsuta\>\"", ",", 
      "\"\<Tejat\>\"", ",", "\"\<Propus\>\""}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Cancer\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Tarf\>\"", ",", "\"\<AsellusAustralis\>\"", ",", 
       "\"\<AsellusBorealis\>\"", ",", "\"\<Iota1Cancri\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<AsellusAustralis\>\"", ",", "\"\<Acubens\>\""}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Leo\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<EpsilonLeonis\>\"", ",", "\"\<Rasalas\>\"", ",", "\"\<Adhafera\>\"",
       ",", "\"\<Algieba\>\"", ",", "\"\<EtaLeonis\>\"", ",", 
      "\"\<Regulus\>\"", ",", "\"\<Chort\>\"", ",", "\"\<Denebola\>\"", ",", 
      "\"\<Zosma\>\"", ",", "\"\<Algieba\>\""}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Virgo\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Alaraph\>\"", ",", "\"\<EtaVirginis\>\"", ",", "\"\<Porrima\>\"", 
       ",", "\"\<ThetaVirginis\>\"", ",", "\"\<Spica\>\"", ",", 
       "\"\<ZetaVirginis\>\"", ",", "\"\<Auva\>\"", ",", "\"\<Porrima\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Spica\>\"", ",", "\"\<KappaVirginis\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ZetaVirginis\>\"", ",", "\"\<TauVirginis\>\"", ",", 
       "\"\<HIP72220\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Auva\>\"", ",", "\"\<Vindemiatrix\>\""}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Libra\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<TauLibrae\>\"", ",", "\"\<UpsilonLibrae\>\"", ",", 
       "\"\<SigmaLibrae\>\"", ",", "\"\<Zubenelgenubi\>\"", ",", 
       "\"\<Zubeneshamali\>\"", ",", "\"\<SigmaLibrae\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Zubeneshamali\>\"", ",", "\"\<Zubenelhakrabi\>\"", ",", 
       "\"\<EtaLibrae\>\"", ",", "\"\<ThetaLibrae\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Scorpius\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Shaula\>\"", ",", "\"\<KappaScorpii\>\"", ",", 
       "\"\<Iota1Scorpii\>\"", ",", "\"\<ThetaScorpii\>\"", ",", 
       "\"\<EtaScorpii\>\"", ",", "\"\<Zeta1Scorpii\>\"", ",", 
       "\"\<Mu1Scorpii\>\"", ",", "\"\<EpsilonScorpii\>\"", ",", 
       "\"\<TauScorpii\>\"", ",", "\"\<Antares\>\"", ",", 
       "\"\<SigmaScorpii\>\"", ",", "\"\<Dschubba\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Jabbah\>\"", ",", "\"\<Acrab\>\"", ",", "\"\<Dschubba\>\"", ",", 
       "\"\<HIP78265\>\"", ",", "\"\<RhoScorpii\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Sagittarius\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<EtaSagittarii\>\"", ",", "\"\<KausAustralis\>\"", ",", 
       "\"\<KausMedia\>\"", ",", "\"\<KausBorealis\>\"", ",", 
       "\"\<PhiSagittarii\>\"", ",", "\"\<Nunki\>\"", ",", 
       "\"\<TauSagittarii\>\"", ",", "\"\<Ascella\>\"", ",", 
       "\"\<PhiSagittarii\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<KausMedia\>\"", ",", "\"\<Gamma1Sagittarii\>\"", ",", 
       "\"\<HIP87072\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<KausBorealis\>\"", ",", "\"\<MuSagittarii\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Nunki\>\"", ",", "\"\<OmicronSagittarii\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<TauSagittarii\>\"", ",", "\"\<HIP96465\>\"", ",", 
       "\"\<HIP98688\>\"", ",", "\"\<Theta1Sagittarii\>\"", ",", 
       "\"\<HIP98032\>\"", ",", "\"\<Arkab\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Capricornus\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<AlGiedi\>\"", ",", "\"\<Dabih\>\"", ",", "\"\<PsiCapricorni\>\"", 
      ",", "\"\<OmegaCapricorni\>\"", ",", "\"\<HIP104234\>\"", ",", 
      "\"\<ZetaCapricorni\>\"", ",", "\"\<DenebAlgiedi\>\"", ",", 
      "\"\<IotaCapricorni\>\"", ",", "\"\<ThetaCapricorni\>\"", ",", 
      "\"\<Dabih\>\""}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Aquarius\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Albali\>\"", ",", "\"\<Sadalsuud\>\"", ",", "\"\<Sadalmelik\>\"", 
       ",", "\"\<Sadachbia\>\"", ",", "\"\<Zeta1Aquarii\>\"", ",", 
       "\"\<EtaAquarii\>\"", ",", "\"\<PhiAquarii\>\"", ",", 
       "\"\<LambdaAquarii\>\"", ",", "\"\<Tau1Aquarii\>\"", ",", 
       "\"\<Skat\>\"", ",", "\"\<HIP114341\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Sadalmelik\>\"", ",", "\"\<Ancha\>\"", ",", 
       "\"\<IotaAquarii\>\""}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Aries\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Mesarthim\>\"", ",", "\"\<Sheratan\>\"", ",", "\"\<Hamal\>\"", ",", 
      "\"\<HIP13209\>\""}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constellation", "[", "\"\<Taurus\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<OmicronTauri\>\"", ",", "\"\<HIP16083\>\"", ",", 
       "\"\<LambdaTauri\>\"", ",", "\"\<GammaTauri\>\"", ",", 
       "\"\<Delta1Tauri\>\"", ",", "\"\<Ain\>\"", ",", "\"\<TauTauri\>\"", 
       ",", "\"\<Alnath\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<GammaTauri\>\"", ",", "\"\<Theta2Tauri\>\"", ",", 
       "\"\<Aldebaran\>\"", ",", "\"\<ZetaTauri\>\""}], "}"}]}], "}"}]}], ";", 
  RowBox[{"zodiacConstellationNames", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "\"\<Leo\>\"", ",", "\"\<Virgo\>\"", ",", "\"\<Libra\>\"", ",", 
     "\"\<Scorpius\>\"", ",", "\"\<Sagittarius\>\"", ",", 
     "\"\<Capricornus\>\"", ",", "\"\<Aquarius\>\"", ",", "\"\<Pisces\>\"", 
     ",", "\"\<Aries\>\"", ",", "\"\<Taurus\>\"", ",", "\"\<Gemini\>\"", ",", 
     "\"\<Cancer\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toCartesian", "[", " ", 
    RowBox[{"ra_", ",", " ", "dec_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"15", " ", "ra", " ", "Degree"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"dec", " ", "Degree"}], "+", 
          RowBox[{"Pi", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"15", " ", "ra", " ", "Degree"}], "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"dec", " ", "Degree"}], "+", 
          RowBox[{"Pi", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"z", " ", "=", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"dec", " ", "Degree"}], "+", 
          RowBox[{"Pi", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "}"}]}]}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"starToCartesian", "[", " ", "name_", " ", "]"}], " ", ":=", 
   RowBox[{"1.25", "*", 
    RowBox[{"toCartesian", "[", " ", 
     RowBox[{
      RowBox[{"AstronomicalData", "[", " ", 
       RowBox[{"name", ",", " ", "\"\<RightAscension\>\""}], "]"}], ",", " ", 
      
      RowBox[{"AstronomicalData", "[", " ", 
       RowBox[{"name", ",", " ", "\"\<Declination\>\""}], "]"}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotConstellation", "[", " ", "constellationName_", "]"}], " ", ":=",
     " ", 
    RowBox[{"{", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Line", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"starToCartesian", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"constellation", "[", "constellationName", "]"}], "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "1", ",", " ", 
         RowBox[{
          RowBox[{"Dimensions", "[", " ", 
           RowBox[{"constellation", "[", "constellationName", "]"}], "]"}], 
          "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], " ", "]"}], "}"}]}], " ",
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphericalToCartesian", "[", 
     RowBox[{"{", 
      RowBox[{"lat_", ",", "lon_"}], "}"}], "]"}], ":=", 
    RowBox[{"1.0", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"lon", " ", "\[Degree]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"lon", " ", "\[Degree]"}], "]"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], ",", 
       RowBox[{"Sin", "[", 
        RowBox[{"lat", " ", "\[Degree]"}], "]"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"sunAngleMean1", "[", "d_", "]"}], ":=", 
     RowBox[{"360", "*", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], "/", "365.2425"}]}]}], 
    RowBox[{"(*", "365.2425", "*)"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sunAngleMean", "[", "d_", "]"}], ":=", 
   RowBox[{"sunAngleArrayCircular", "[", 
    RowBox[{"[", 
     RowBox[{"1", "-", "offsetNbTimeStep", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], "*", "timeStepPerDay"}], "+", 
      RowBox[{"12", "*", "timeStepPerHour"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sunAngleTrue", "[", "d_", "]"}], ":=", 
   RowBox[{"sunAngleArray", "[", 
    RowBox[{"[", 
     RowBox[{"1", "-", "offsetNbTimeStep", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], "*", "timeStepPerDay"}], "+", 
      RowBox[{"12", "*", "timeStepPerHour"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latCircle", "[", "lat_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lon", "=", "0.0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sphericalToCartesian", "[", 
        RowBox[{"{", 
         RowBox[{"lat", ",", 
          RowBox[{"lon", "+", "i"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "360", ",", "1"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lonCircle", "[", "lon_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lat", "=", "0.0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sphericalToCartesian", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lat", "+", "i"}], ",", "lon"}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "360", ",", "1"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polarAxis", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globe", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.95", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Blue", ",", "0.0"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Specularity", "[", 
          RowBox[{"White", ",", "50"}], "]"}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Sphere", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.0"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Gray", ",", "0.40"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Specularity", "[", 
          RowBox[{"White", ",", "50"}], "]"}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"sphericalToCartesian", ",", 
             RowBox[{"CountryData", "[", 
              RowBox[{"#", ",", "\"\<SchematicCoordinates\>\""}], "]"}], ",", 
             
             RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "&"}], ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"CountryData", "[", "All", "]"}], ",", 
            "\"\<Antarctica\>\""}], "}"}]}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Green", ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"1.0", "*", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"1.0", "*", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"1.25", "*", "1.0", "*", "polarAxis"}], "]"}]}], "}"}], 
       ","}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Gray", ",", "0.9"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Gray", ",", "0.10"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", "earthOrbitalTilt", "]"}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Gray", ",", "0.10"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", 
         RowBox[{"-", "earthOrbitalTilt"}], "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Gray", ",", "0.10"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", 
         RowBox[{"90", "-", "earthOrbitalTilt"}], "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
       RowBox[{"Lighter", "[", 
        RowBox[{"Gray", ",", "0.10"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", 
         RowBox[{
          RowBox[{"-", "90"}], "+", "earthOrbitalTilt"}], "]"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Gray", ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"lonCircle", "[", "0", "]"}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equatorPlane", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.00", "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"1.5", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Gray", ",", "0.2"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"latCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Gray", ",", "0.9"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"1.25", "*", 
         RowBox[{"latCircle", "[", "0", "]"}]}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eclipticPlane", "=", 
   RowBox[{"GeometricTransformation", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.00", "]"}], ",", 
         RowBox[{"Polygon", "[", 
          RowBox[{"1.5", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "1", "]"}], ",", 
         RowBox[{"Darker", "[", 
          RowBox[{"Gray", ",", "0.9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"1.25", "*", 
           RowBox[{"latCircle", "[", "0", "]"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"earthOrbitalTilt", " ", "\[Degree]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vernalAxis", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Green", ",", "0.25"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"1.5", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "]"}]}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.004", "]"}], ",", 
       RowBox[{"Opacity", "[", "1", "]"}], ",", 
       RowBox[{"Darker", "[", 
        RowBox[{"Red", ",", "0.25"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"1.5", "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanSun", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rotMeanSun", ",", "toMeanSunEquator"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotMeanSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleMean", "[", "d", "]"}], "\[Degree]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toMeanSunEquator", "=", 
       RowBox[{"rotMeanSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Orange", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"1.25", "*", "toMeanSunEquator"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"1.25", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              "toMeanSunEquator"}], "}"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trueSun", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rotTrueSun", ",", "toTrueSunEquinox", ",", "toTrueSunEquator", ",", 
       "trueSunToEquator"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotTrueSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleTrue", "[", "d", "]"}], "\[Degree]"}], ",", 
         "rotSunAxis"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquinox", "=", 
       RowBox[{"rotTrueSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquator", "=", "toTrueSunEquinox"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"toTrueSunEquator", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trueSunToEquator", "=", 
       RowBox[{"{", 
        RowBox[{"toTrueSunEquinox", ",", "toTrueSunEquator"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Yellow", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"1.25", "*", "toTrueSunEquinox"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"1.25", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              "toTrueSunEquator"}], "}"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"1.25", "*", "trueSunToEquator"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toTrueSun", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rotTrueSun", ",", "toTrueSunEquinox"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotTrueSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleTrue", "[", "d", "]"}], "\[Degree]"}], ",", 
         "rotSunAxis"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquinox", "=", 
       RowBox[{"rotTrueSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vectorAngleEquator", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"va", "=", 
       RowBox[{"VectorAngle", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"a", ",", "b"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], ">=", "0"}], ",", "va", ",", 
       RowBox[{"-", "va"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angleTrueMinusMeanSun", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rotMeanSun", ",", "toMeanSunEquator", ",", "rotTrueSun", ",", 
       "toTrueSunEquinox", ",", "toTrueSunEquator", ",", "trueSunZ"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotMeanSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleMean", "[", "d", "]"}], "\[Degree]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toMeanSunEquator", "=", 
       RowBox[{"rotMeanSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rotTrueSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleTrue", "[", "d", "]"}], "\[Degree]"}], ",", 
         "rotSunAxis"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquinox", "=", 
       RowBox[{"rotTrueSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquator", "=", "toTrueSunEquinox"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"toTrueSunEquator", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"trueSunZ", "=", 
       RowBox[{"toTrueSunEquinox", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vectorAngleEquator", "[", 
          RowBox[{"toTrueSunEquator", ",", "toMeanSunEquator"}], "]"}], "*", 
         RowBox[{"360.0", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "Pi"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ArcSin", "[", "trueSunZ", "]"}], "*", 
         RowBox[{"360.0", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "Pi"}], ")"}]}]}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tableEOT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"angleTrueMinusMeanSun", "[", "d", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "366"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tableAnalemma", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"angleTrueMinusMeanSun", "[", "d", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"angleTrueMinusMeanSun", "[", "d", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "366"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tableAnalemmaCart", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"sphericalToCartesian", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"angleTrueMinusMeanSun", "[", "d", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{
          RowBox[{"angleTrueMinusMeanSun", "[", "d", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"d", ",", "366"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analemma", "=", 
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Thickness", "[", "0.005", "]"}], ","}], "*)"}], 
    RowBox[{"Thin", ",", 
     RowBox[{"Opacity", "[", "1.0", "]"}], ",", "Orange", ",", 
     RowBox[{"Line", "[", "tableAnalemmaCart", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listPlotEOT", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{"tableEOT", ",", "\[IndentingNewLine]", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "370"}], "}"}], ",", "Automatic"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Day\\nsince\\nvernal\\nequinox\>\"", ",", 
            "\"\<True vs. Mean\\n Sun Angle\\n(t-m)\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"AspectRatio", "\[Rule]", "1.5"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"d", ",", 
               RowBox[{"tableEOT", "[", 
                RowBox[{"[", "d", "]"}], "]"}]}], "}"}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"tableEOT", "*", "24", "*", 
          RowBox[{"60", "/", 
           RowBox[{"(", 
            RowBox[{"360.", "*", 
             RowBox[{"366", "/", "365"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5"}], ",", "370"}], "}"}], ",", "Automatic"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Day\\nsince\\nvernal\\nequinox\>\"", ",", 
            "\"\<True vs. Mean\\n Sun Time\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"AspectRatio", "\[Rule]", "1.5"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"d", ",", 
               RowBox[{
                RowBox[{"tableEOT", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "*", "24", "*", 
                RowBox[{"60", "/", 
                 RowBox[{"(", 
                  RowBox[{"360.", "*", 
                   RowBox[{"366", "/", "365"}]}], ")"}]}]}]}], "}"}], "]"}]}],
            "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"tableAnalemma", ",", "\[IndentingNewLine]", 
         RowBox[{"Filling", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"1.1", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "earthOrbitalTilt"}], ",", "earthOrbitalTilt"}], 
              "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Azimuth\\nTrue\\nvs.\\nMean\\nSun\\n(t-m)\>\"", ",", 
            "\"\<Altitude True vs.\\nMean Sun (h)\>\""}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"AspectRatio", "\[Rule]", "1.0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Large", "]"}], ",", "Red", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"tableAnalemma", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"tableAnalemma", "[", 
                RowBox[{"[", 
                 RowBox[{"d", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentDate", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "date", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"date", "=", 
       RowBox[{"DatePlus", "[", 
        RowBox[{"startDateTime", ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "\"\<Day\>\""}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"date", "=", 
       RowBox[{"date", "+", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "12", ",", "0", ",", "0"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"DateString", "[", "date", "]"}], ",", "Bold", ",", "14"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentDate2", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "date", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"date", "=", 
       RowBox[{"DatePlus", "[", 
        RowBox[{"startDateTime", ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "\"\<Day\>\""}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"date", "=", 
       RowBox[{"date", "+", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "12", ",", "0", ",", "0"}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"DateString", "[", 
          RowBox[{"date", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<DayShort\>\"", ",", "\"\< \>\"", ",", "\"\<MonthName\>\""}], 
            "}"}]}], "]"}], ",", "Bold", ",", "14"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"graphEOT3D", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rotMeanSun", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotMeanSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleMean", "[", "d", "]"}], "\[Degree]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GeometricTransformation", "[", 
           RowBox[{"globe", ",", "rotMeanSun"}], "]"}], ",", 
          "\[IndentingNewLine]", "equatorPlane", ",", "\[IndentingNewLine]", 
          "eclipticPlane", ",", "\[IndentingNewLine]", "vernalAxis", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"meanSun", "[", "d", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"trueSun", "[", "d", "]"}], ","}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{"plotConstellation", ",", "zodiacConstellationNames"}], 
            "]"}]}], "*)"}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PreserveImageOptions", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"2.0", "*", 
            RowBox[{"sphericalToCartesian", "[", 
             RowBox[{"{", 
              RowBox[{"30", ",", 
               RowBox[{"15", "+", "d"}]}], "}"}], "]"}]}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ViewPoint", "\[Rule]", "Top"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trueSunBis", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rotTrueSun", ",", "toTrueSunEquinox"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotTrueSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleTrue", "[", "d", "]"}], "\[Degree]"}], ",", 
         "rotSunAxis"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"toTrueSunEquinox", "=", 
       RowBox[{"rotTrueSun", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Yellow", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"1.00", "*", "toTrueSunEquinox"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Opacity", "[", "1", "]"}], ",", 
          RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"1.00", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              "toTrueSunEquinox"}], "}"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"graphEOT3DBis", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rotMeanSun", ",", "orthogEcliptic"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rotMeanSun", "=", 
       RowBox[{"RotationTransform", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sunAngleMean", "[", "d", "]"}], "\[Degree]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"orthogEcliptic", "=", 
       RowBox[{
        RowBox[{"RotationTransform", "[", 
         RowBox[{
          RowBox[{"earthOrbitalTilt", " ", "\[Degree]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GeometricTransformation", "[", 
           RowBox[{"globe", ",", "rotMeanSun"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"trueSunBis", "[", "d", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GeometricTransformation", "[", 
           RowBox[{"analemma", ",", "rotMeanSun"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"currentDate2", "[", "d", "]"}], ",", 
            RowBox[{"1.2", "*", "orthogEcliptic"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PreserveImageOptions", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ViewVertical", "\[Rule]", "orthogEcliptic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toCardinalPoint", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "east", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"east", "=", 
       RowBox[{
        RowBox[{"RotationTransform", "[", 
         RowBox[{
          RowBox[{"cityLong", " ", "\[Degree]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Orange", ",", "Thin", ",", 
         RowBox[{"Arrowheads", "[", "Medium", "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"1.0", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sphericalToCartesian", "[", 
              RowBox[{"{", 
               RowBox[{"cityLat", ",", "cityLong"}], "}"}], "]"}], ",", 
             RowBox[{
              RowBox[{"sphericalToCartesian", "[", 
               RowBox[{"{", 
                RowBox[{"cityLat", ",", "cityLong"}], "}"}], "]"}], "+", 
              "east"}]}], "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allEOT", "[", "d_", "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"2.0", "*", 
            RowBox[{"sphericalToCartesian", "[", 
             RowBox[{"{", 
              RowBox[{"30", ",", 
               RowBox[{"10", "+", "d"}]}], "}"}], "]"}]}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
          RowBox[{"ViewAngle", "\[Rule]", 
           RowBox[{"28", "\[Degree]"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"currentDate", "[", "d", "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
         "]"}], ",", 
        RowBox[{
         RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.56223010864848*^9, 3.562230201962955*^9}, {
   3.56223027184783*^9, 3.56223030066107*^9}, {3.562230331315608*^9, 
   3.562230434296012*^9}, {3.562230517054531*^9, 3.562230636977087*^9}, {
   3.5622307004840813`*^9, 3.562230701327505*^9}, {3.562230859796081*^9, 
   3.562230880775186*^9}, {3.5622309342778797`*^9, 3.562230937135356*^9}, {
   3.562230970288761*^9, 3.562230971572096*^9}, {3.562231005455241*^9, 
   3.562231084618487*^9}, {3.562231137932045*^9, 3.562231178691472*^9}, {
   3.562231278101787*^9, 3.56223136656257*^9}, {3.562231663936221*^9, 
   3.56223171575005*^9}, {3.5622317815381403`*^9, 3.562231803026075*^9}, {
   3.562231834304998*^9, 3.562231882552795*^9}, {3.562231915183854*^9, 
   3.562231934679521*^9}, {3.562231986282915*^9, 3.562232002116251*^9}, {
   3.562232036028286*^9, 3.562232101404085*^9}, {3.562232312419999*^9, 
   3.5622325154094257`*^9}, {3.562232585306535*^9, 3.562232586661687*^9}, {
   3.5622326615119667`*^9, 3.562232679738103*^9}, {3.562232738398848*^9, 
   3.562232785645577*^9}, {3.5622328207278957`*^9, 3.562232989842174*^9}, {
   3.56223303669659*^9, 3.562233114930026*^9}, {3.562233150248485*^9, 
   3.5622332211034327`*^9}, 3.562233277161577*^9, 3.562233314458269*^9, {
   3.562233371217949*^9, 3.5622334903135653`*^9}, {3.5622335243812*^9, 
   3.562233556362718*^9}, {3.562233599894758*^9, 3.562233603193307*^9}, {
   3.562233656935544*^9, 3.5622336998022633`*^9}, 3.562233737415834*^9, {
   3.562233801056699*^9, 3.562234224144725*^9}, {3.5622344435557203`*^9, 
   3.562234610184675*^9}, {3.562235466339142*^9, 3.562235484925399*^9}, {
   3.5622356399464808`*^9, 3.5622356500437193`*^9}, {3.562236686334958*^9, 
   3.562236756789654*^9}, {3.562236839901523*^9, 3.56223688397025*^9}, {
   3.562236928255013*^9, 3.5622369618153152`*^9}, {3.562236998533762*^9, 
   3.5622370035652943`*^9}, {3.562237061344905*^9, 3.5622371023498583`*^9}, {
   3.562237155417212*^9, 3.5622371693700037`*^9}, {3.562237244505349*^9, 
   3.5622372517200117`*^9}, {3.562237297604805*^9, 3.5622373031990547`*^9}, {
   3.5622374168682623`*^9, 3.5622375263209267`*^9}, 3.5622377773556767`*^9, 
   3.562237974924883*^9, {3.562238268628998*^9, 3.562238296428719*^9}, {
   3.5622387108763742`*^9, 3.562238740683221*^9}, {3.562239920211145*^9, 
   3.562239977074277*^9}, 3.562240007667653*^9, {3.5622401313847847`*^9, 
   3.562240134500379*^9}, {3.562243118373838*^9, 3.5622431205969687`*^9}, {
   3.562251409064036*^9, 3.5622515686574087`*^9}, {3.5622516016439457`*^9, 
   3.562251610829028*^9}, {3.562251665223283*^9, 3.562251725755364*^9}, {
   3.562251757859247*^9, 3.562251769479781*^9}, {3.5622520233659573`*^9, 
   3.562252070275058*^9}, {3.562252104715651*^9, 3.562252138729924*^9}, {
   3.562252784896864*^9, 3.5622527872232723`*^9}, {3.562256890066716*^9, 
   3.562256894951872*^9}, {3.562256925628069*^9, 3.562256981440605*^9}, 
   3.562257020068243*^9, {3.562257072983871*^9, 3.5622571645044518`*^9}, {
   3.56225719460639*^9, 3.562257204893408*^9}, {3.562257257534008*^9, 
   3.5622572679884768`*^9}, {3.562258009324813*^9, 3.562258012444849*^9}, {
   3.5622599877534647`*^9, 3.562260043155204*^9}, {3.562260074344911*^9, 
   3.5622603972491426`*^9}, {3.5622604755390377`*^9, 3.562260476131238*^9}, {
   3.562260560301551*^9, 3.5622605804989643`*^9}, 3.562260777556697*^9, {
   3.5622608135080147`*^9, 3.562260847067912*^9}, {3.562260912676874*^9, 
   3.562261012772131*^9}, {3.562261112011685*^9, 3.5622611277085114`*^9}, {
   3.562261161740569*^9, 3.562261162426906*^9}, {3.5623535941892767`*^9, 
   3.562353633446227*^9}, {3.562353673734757*^9, 3.5623536738456297`*^9}, {
   3.5623538651018744`*^9, 3.562353884584399*^9}, {3.562353961600686*^9, 
   3.562353984601201*^9}, {3.562354183347661*^9, 3.562354208185977*^9}, {
   3.562354263722124*^9, 3.5623542642481422`*^9}, {3.562354295815425*^9, 
   3.562354296301662*^9}, {3.562354361991165*^9, 3.5623543625347643`*^9}, {
   3.562354404237569*^9, 3.562354404773508*^9}, {3.562354482447815*^9, 
   3.562354562088235*^9}, {3.5623546274471292`*^9, 3.562354644166875*^9}, {
   3.562354696649644*^9, 3.562354716696186*^9}, {3.562355616208226*^9, 
   3.562355653252255*^9}, {3.56235569580616*^9, 3.562355697574901*^9}, {
   3.562356002641199*^9, 3.562356029366315*^9}, {3.562356179001945*^9, 
   3.562356195830295*^9}, {3.562357358197275*^9, 3.562357430867221*^9}, {
   3.562357589923478*^9, 3.562357591579474*^9}, {3.562357666180298*^9, 
   3.562357685704227*^9}, {3.562357761739846*^9, 3.5623578055455647`*^9}, {
   3.5623578605141773`*^9, 3.562357888626136*^9}, {3.562357929330017*^9, 
   3.562357978902237*^9}, {3.562358065048421*^9, 3.56235812836786*^9}, {
   3.56235816653296*^9, 3.562358166848741*^9}, {3.56260405423339*^9, 
   3.562604056452832*^9}, {3.562604125841816*^9, 3.562604143570154*^9}, {
   3.562604227567995*^9, 3.5626042333665257`*^9}, {3.562604330987734*^9, 
   3.5626043582593193`*^9}, {3.56260440244633*^9, 3.562604487804545*^9}, {
   3.562604546428177*^9, 3.562604548194969*^9}, 3.5626047006614933`*^9, {
   3.562604861604229*^9, 3.5626049013211813`*^9}, {3.5626079758990593`*^9, 
   3.562607978951364*^9}, {3.562608518278796*^9, 3.562608518437924*^9}, {
   3.56260857565174*^9, 3.562608620336781*^9}, {3.562608718252123*^9, 
   3.562608795737916*^9}, {3.562608925533242*^9, 3.562608931403029*^9}, {
   3.562608968996727*^9, 3.5626089827553988`*^9}, {3.562609039994506*^9, 
   3.562609040790031*^9}, {3.562609173750991*^9, 3.562609175362054*^9}, {
   3.56261333447185*^9, 3.562613403387513*^9}, {3.56262012675439*^9, 
   3.562620131298669*^9}, {3.5626204964144373`*^9, 3.56262050120581*^9}, 
   3.5626206591931562`*^9, {3.562621050482005*^9, 3.562621066352208*^9}, {
   3.562621206578144*^9, 3.562621207041512*^9}, {3.562621263023704*^9, 
   3.562621264071063*^9}, 3.56262132477676*^9, 3.5626213750156*^9, {
   3.562621429745417*^9, 3.562621482340507*^9}, {3.562621576799325*^9, 
   3.5626215769732733`*^9}, {3.562621613883264*^9, 3.562621614051429*^9}, {
   3.562840653305573*^9, 3.5628406749035482`*^9}, {3.5628408601733007`*^9, 
   3.562840865456564*^9}, {3.5628411637033043`*^9, 3.562841165376646*^9}, {
   3.562841655123611*^9, 3.562841676328526*^9}, {3.562842872856332*^9, 
   3.562842916986342*^9}, {3.562843246762218*^9, 3.562843250571559*^9}, {
   3.562858708782364*^9, 3.562858730034225*^9}, {3.5628587773091183`*^9, 
   3.562858810614441*^9}, {3.562858944394629*^9, 3.562858969814755*^9}, {
   3.562859034616131*^9, 3.56285903626633*^9}, {3.562859091425764*^9, 
   3.562859158101646*^9}, {3.56285920791826*^9, 3.562859299177721*^9}, {
   3.562859372692298*^9, 3.5628594168997507`*^9}, {3.5628595336554213`*^9, 
   3.562859591663048*^9}, {3.562859792592514*^9, 3.562859935814416*^9}, {
   3.5628599681885033`*^9, 3.562859987044529*^9}, {3.562860134662483*^9, 
   3.562860144419951*^9}, {3.562860266631382*^9, 3.562860290442257*^9}, {
   3.562860370885453*^9, 3.562860397877891*^9}, {3.562860863358664*^9, 
   3.562860870652299*^9}, {3.5628615526675787`*^9, 3.5628615769125338`*^9}, 
   3.56286162404669*^9, {3.56286276799404*^9, 3.562862789230102*^9}, {
   3.562862880342194*^9, 3.562862881868773*^9}, {3.562863214892318*^9, 
   3.562863219588234*^9}, 3.5628632608028803`*^9, {3.562863452535681*^9, 
   3.5628635672987947`*^9}, {3.562863613323326*^9, 3.562863637102409*^9}, {
   3.562863687057605*^9, 3.562863695540868*^9}, {3.5628638753521957`*^9, 
   3.56286387728941*^9}, {3.5628639436011953`*^9, 3.562863973368935*^9}, {
   3.562864119018448*^9, 3.562864161072884*^9}, {3.562864257001769*^9, 
   3.562864331687715*^9}, 3.562864384923348*^9, {3.562864438355348*^9, 
   3.5628644563798313`*^9}, 3.562864606273458*^9, 3.562864890494318*^9, {
   3.562864945210298*^9, 3.562864948264515*^9}, {3.562865143888427*^9, 
   3.562865158105522*^9}, {3.562865877710833*^9, 3.5628658985026293`*^9}, {
   3.562866005342085*^9, 3.562866054291409*^9}, {3.562866098527854*^9, 
   3.562866152408328*^9}, {3.562866262326181*^9, 3.562866262988675*^9}, {
   3.562866584248054*^9, 3.562866584841305*^9}, {3.562866878593956*^9, 
   3.562866881639948*^9}, {3.562866912846973*^9, 3.56286691488361*^9}, {
   3.562867158182827*^9, 3.562867158407098*^9}, {3.562867214005597*^9, 
   3.562867320672773*^9}, {3.56286736323591*^9, 3.562867366418886*^9}, {
   3.562867498726224*^9, 3.562867534785593*^9}, {3.562867568903865*^9, 
   3.5628676953966293`*^9}, {3.562867761267806*^9, 3.562867765212751*^9}, 
   3.562867824626772*^9, {3.5628680480827*^9, 3.562868054121677*^9}, {
   3.56286813058566*^9, 3.56286813891082*^9}, {3.562868468796321*^9, 
   3.562868497454219*^9}, {3.562868562479907*^9, 3.5628685727086*^9}, {
   3.562870212140667*^9, 3.562870312021475*^9}, {3.562870436023965*^9, 
   3.562870459002879*^9}, 3.562870528094903*^9, {3.562870587354301*^9, 
   3.562870589205462*^9}, 3.5628728010825243`*^9, 3.5628730488987017`*^9, 
   3.562875508829692*^9, {3.562875544060699*^9, 3.562875569326123*^9}, 
   3.5628760537301397`*^9, {3.5628763787560053`*^9, 3.562876379057252*^9}, {
   3.562876411690213*^9, 3.562876419491234*^9}, {3.562876525635275*^9, 
   3.562876539634029*^9}, {3.562876659429365*^9, 3.5628767074356947`*^9}, {
   3.562876791159916*^9, 3.562876823758349*^9}, {3.562876858660191*^9, 
   3.562876881319471*^9}, {3.56287738751435*^9, 3.562877447467863*^9}, 
   3.562955078367292*^9, {3.5629551518871727`*^9, 3.5629551555253553`*^9}, {
   3.562955195085153*^9, 3.562955195420834*^9}, {3.562955228191043*^9, 
   3.5629552372714653`*^9}, {3.5629552940855713`*^9, 3.562955294534617*^9}, {
   3.562955334545442*^9, 3.562955374794804*^9}, {3.5629554645123034`*^9, 
   3.5629554648904333`*^9}, {3.562955556680702*^9, 3.562955602812628*^9}, {
   3.5629557133311443`*^9, 3.562955839233779*^9}, {3.562955989284333*^9, 
   3.562956145451989*^9}, {3.562956213876605*^9, 3.5629562196564827`*^9}, {
   3.562956282913835*^9, 3.562956343409236*^9}, {3.562956443039504*^9, 
   3.562956443436002*^9}, {3.562956539248657*^9, 3.562956541280836*^9}, 
   3.5629565857769213`*^9, {3.562956633013074*^9, 3.562956659609877*^9}, {
   3.5629567309626083`*^9, 3.562956767178781*^9}, {3.562956978161187*^9, 
   3.562956988213916*^9}, {3.5629570683055573`*^9, 3.562957074168305*^9}, {
   3.5629576252168303`*^9, 3.5629576304047413`*^9}, {3.562957782376687*^9, 
   3.562957785070558*^9}, {3.56295886322173*^9, 3.56295887195385*^9}, {
   3.562958959858489*^9, 3.562958968069178*^9}, {3.562959538373721*^9, 
   3.562959557781107*^9}}],

Cell[BoxData[
 RowBox[{"allEOT", "[", "50", "]"}]], "Input",
 CellChangeTimes->{{3.5622369713359747`*^9, 3.562236975107415*^9}, {
   3.562237027332106*^9, 3.562237027427598*^9}, {3.562237208311668*^9, 
   3.562237234373654*^9}, {3.562237642227332*^9, 3.56223764228967*^9}, {
   3.562237708506596*^9, 3.562237711298786*^9}, {3.5622378486937847`*^9, 
   3.562237851691622*^9}, {3.562238318818316*^9, 3.562238318928216*^9}, {
   3.562238754524514*^9, 3.562238754588347*^9}, {3.562239233028862*^9, 
   3.562239234344716*^9}, {3.5622400500863123`*^9, 3.562240050440425*^9}, {
   3.562240390165501*^9, 3.562240390226418*^9}, {3.562240529982687*^9, 
   3.56224053035712*^9}, 3.562243163336112*^9, {3.5622440552481127`*^9, 
   3.562244055422182*^9}, {3.562251345344573*^9, 3.562251345677631*^9}, {
   3.562251782106533*^9, 3.562251782186185*^9}, {3.5622520840690002`*^9, 
   3.562252096005094*^9}, {3.562257224573757*^9, 3.562257224669738*^9}, {
   3.562261074435102*^9, 3.5622610745761013`*^9}, {3.562357281382761*^9, 
   3.562357281723867*^9}, {3.562357824826272*^9, 3.562357824928767*^9}, {
   3.562358147556056*^9, 3.562358148123877*^9}, {3.562523991538464*^9, 
   3.5625239917525377`*^9}, {3.562608128995122*^9, 3.562608129449238*^9}, {
   3.562844110591737*^9, 3.5628441231281567`*^9}, {3.562844173208699*^9, 
   3.562844173312489*^9}, 3.562867931719549*^9, 3.562956253167239*^9, 
   3.562956363016432*^9, {3.56295728180095*^9, 3.562957283288772*^9}, {
   3.5629590132355537`*^9, 3.562959013296483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nbOneEOT", "[", "d_", "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"graphEOT3D", "[", "d", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"2.0", "*", 
       RowBox[{"sphericalToCartesian", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"20", "+", 
           RowBox[{"15", "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", " ", "Pi", "*", 
              RowBox[{"d", "/", "365"}]}], "]"}]}]}], ",", 
          RowBox[{"5", "+", "d"}]}], "}"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ViewVertical", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ViewAngle", "\[Rule]", 
      RowBox[{"28", "\[Degree]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5626049537839603`*^9, 3.562604995634314*^9}, {
  3.5626054147520123`*^9, 3.562605436009947*^9}, {3.562606466919991*^9, 
  3.562606505286633*^9}, {3.562606594688075*^9, 3.5626066025972033`*^9}, {
  3.562606634918914*^9, 3.562606639285019*^9}, {3.562606707934898*^9, 
  3.562606723768292*^9}, {3.56260683634671*^9, 3.562606836737062*^9}, {
  3.562606894791782*^9, 3.5626069003934526`*^9}, {3.562606933289434*^9, 
  3.562606945232726*^9}, {3.562606999909803*^9, 3.562607001890944*^9}, {
  3.5626077785361013`*^9, 3.5626077874720163`*^9}, {3.562609117309537*^9, 
  3.562609134917675*^9}, {3.562842983368773*^9, 3.562843021015836*^9}}],

Cell[BoxData[
 RowBox[{"output", "=", 
  RowBox[{"nbOneEOT", "[", "25", "]"}]}]], "Input",
 CellChangeTimes->{{3.5626964257536993`*^9, 3.5626964431463118`*^9}, 
   3.562842988373765*^9, {3.562843047870461*^9, 3.5628430494541683`*^9}}],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"nbOneEOT", "[", "d", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "365", ",", "2"}], "}"}]}], "]"}]}], ";"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", "\"\<picEOT1\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", 
       "output", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", "0.08"}], ",", 
       RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], 
      "]"}], ";"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5626056027803087`*^9, 3.562605682819126*^9}, {
   3.562605726971994*^9, 3.5626057829121532`*^9}, {3.562605831209301*^9, 
   3.562605831549906*^9}, {3.562605980480612*^9, 3.5626060085674133`*^9}, {
   3.562607048598016*^9, 3.5626070701842833`*^9}, 3.562608402822618*^9, 
   3.562609241955468*^9, 3.562609507624815*^9, 3.562613937364581*^9, {
   3.562617070791675*^9, 3.562617076783634*^9}, {3.562617583116458*^9, 
   3.562617587323818*^9}, {3.5626178362471943`*^9, 3.5626178379668283`*^9}, {
   3.5626181966775007`*^9, 3.562618206642201*^9}, {3.562620586145697*^9, 
   3.562620586248514*^9}, {3.5626212276150017`*^9, 3.562621227710781*^9}, {
   3.562686284079349*^9, 3.562686302149994*^9}, {3.562686649547044*^9, 
   3.562686650125237*^9}, 3.562696456055934*^9, {3.5627025386546497`*^9, 
   3.5627025478538923`*^9}, {3.562843039274776*^9, 3.5628430398882303`*^9}, {
   3.562843075111847*^9, 3.562843085440341*^9}, 3.5628431869738197`*^9, 
   3.562844198481268*^9, 3.5628443200645943`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nbTwoEOT", "[", "d_", "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"2.0", "*", 
            RowBox[{"sphericalToCartesian", "[", 
             RowBox[{"{", 
              RowBox[{"30", ",", 
               RowBox[{"10", "+", "d"}]}], "}"}], "]"}]}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
          RowBox[{"ViewAngle", "\[Rule]", 
           RowBox[{"28", "\[Degree]"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
         "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"currentDate2", "[", "d", "]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "Infinity"}], ",", "0"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
        "]"}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "280"}]}], "]"}]}], "*)"}], 
       "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.562606076343479*^9, {3.562615429871709*^9, 3.562615447049979*^9}, {
   3.562615498978589*^9, 3.5626155029219503`*^9}, {3.562615688812027*^9, 
   3.562615740029737*^9}, {3.562617663198958*^9, 3.5626176656626253`*^9}, {
   3.5626176971116*^9, 3.562617703079095*^9}, {3.5626879340655613`*^9, 
   3.562687993111806*^9}, 3.562841195681911*^9, 3.562841368613502*^9, {
   3.562841405251317*^9, 3.56284149935606*^9}, 3.562843193082795*^9}],

Cell[BoxData[
 RowBox[{"nbTwoEOT", "[", "40", "]"}]], "Input",
 CellChangeTimes->{
  3.56261566077715*^9, {3.562862113126542*^9, 3.562862131445386*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"name", "=", "\"\<picEOT2\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
       RowBox[{"name", "<>", "\"\<.png\>\""}]}], "}"}], "]"}], ",", "output", 
    ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.562615533741796*^9, 3.562615581791605*^9}, {
   3.56261564566693*^9, 3.5626156625612164`*^9}, 3.5626964726969357`*^9, {
   3.562841211466332*^9, 3.562841216849826*^9}, 3.562841377345693*^9, 
   3.562843212975934*^9, 3.5628443371778507`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nbThreeEOT", "[", "d_", "]"}], ":=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"currentDate2", "[", "d", "]"}], ",", "SpanFromLeft"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"listPlotEOT", "[", "d", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"graphEOT3D", "[", "d", "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "275"}], ",", 
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"2.0", "*", 
            RowBox[{"sphericalToCartesian", "[", 
             RowBox[{"{", 
              RowBox[{"30", ",", 
               RowBox[{"10", "+", "d"}]}], "}"}], "]"}]}]}], ",", 
          RowBox[{"ViewVertical", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
          RowBox[{"ViewAngle", "\[Rule]", 
           RowBox[{"28", "\[Degree]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Method", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], 
          "*)"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.562687451549045*^9, 3.562687454882904*^9}, {
   3.562687488934284*^9, 3.562687518700358*^9}, {3.562687549089119*^9, 
   3.5626875528892183`*^9}, {3.562687634379487*^9, 3.5626876432510643`*^9}, {
   3.5626876943668623`*^9, 3.562687819763976*^9}, {3.562688049344475*^9, 
   3.5626880867528143`*^9}, 3.562688468109188*^9, {3.562688538631465*^9, 
   3.562688601245673*^9}, {3.562688657295618*^9, 3.562688710911109*^9}, {
   3.5626887744507027`*^9, 3.562688775191063*^9}, {3.562688937697996*^9, 
   3.5626889592662687`*^9}, {3.562688998162269*^9, 3.562689017898448*^9}, 
   3.5626901847032747`*^9, {3.5627052164354887`*^9, 3.562705224210733*^9}, 
   3.5628411594190693`*^9}],

Cell[BoxData[
 RowBox[{"output", "=", 
  RowBox[{"nbThreeEOT", "[", "160", "]"}]}]], "Input",
 CellChangeTimes->{{3.562687610104694*^9, 3.56268761080048*^9}, 
   3.562687669624983*^9, {3.562687826506353*^9, 3.562687826585848*^9}, {
   3.56269019246449*^9, 3.562690212184585*^9}, {3.562875455261178*^9, 
   3.562875467999578*^9}}],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"nbThreeEOT", "[", "d", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "365", ",", "2"}], "}"}]}], "]"}]}], ";"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"name", "=", "\"\<picEOT3\>\""}], ";"}], 
  "*)"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", "\"\<picEOT4\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"name", "=", "\"\<picEOT5\>\""}], ";"}], 
  "*)"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
          RowBox[{"name", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", 
       "output", ",", 
       RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", "0.08"}], ",", 
       RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], 
      "]"}], ";"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5626888001815147`*^9, 3.562688831349729*^9}, 
   3.5626890316153*^9, {3.56268952206171*^9, 3.5626895223717537`*^9}, {
   3.562695000912697*^9, 3.562695010815071*^9}, {3.562696362187893*^9, 
   3.562696368835636*^9}, {3.562702512197955*^9, 3.562702515941564*^9}, {
   3.5628412895290833`*^9, 3.562841311675585*^9}, 3.562843435035781*^9, 
   3.5628435179039516`*^9, {3.562844356976959*^9, 3.5628443586476307`*^9}, {
   3.562844689353332*^9, 3.562844698284174*^9}, 3.562844755530407*^9, {
   3.5628450178072443`*^9, 3.562845037106063*^9}, {3.562845252648054*^9, 
   3.562845254401135*^9}, 3.5628472076356583`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tabEOT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tableEOT", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"earthOrbitalTilt", "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"sunAngleTrue", "[", "i", "]"}], "\[Degree]"}], "]"}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "tableEOT", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"tabEOT", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"min", "=", 
   RowBox[{"Min", "[", 
    RowBox[{"tabEOT", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imax", "=", 
   RowBox[{"First", "@", 
    RowBox[{"First", "@", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"tabEOT", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "max"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imin", "=", 
   RowBox[{"First", "@", 
    RowBox[{"First", "@", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"tabEOT", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "min"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmax", "=", 
   RowBox[{"DateString", "[", 
    RowBox[{
     RowBox[{"DatePlus", "[", 
      RowBox[{"startDateTime", ",", 
       RowBox[{"{", 
        RowBox[{"imax", ",", "\"\<Day\>\""}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<DayShort\>\"", ",", "\"\< \>\"", ",", "\"\<MonthName\>\"", ",", 
       " ", "\"\< \>\"", ",", "\"\<Year\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmin", "=", 
   RowBox[{"DateString", "[", 
    RowBox[{
     RowBox[{"DatePlus", "[", 
      RowBox[{"startDateTime", ",", 
       RowBox[{"{", 
        RowBox[{"imin", ",", "\"\<Day\>\""}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<DayShort\>\"", ",", "\"\< \>\"", ",", "\"\<MonthName\>\"", ",", 
       " ", "\"\< \>\"", ",", "\"\<Year\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eotmax", "=", 
   RowBox[{"N", "[", 
    RowBox[{"max", "*", "24", "*", "60", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"366", "/", "365"}], ")"}], "/", "360"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eotmaxms", "=", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{"Quotient", "[", 
      RowBox[{"eotmax", ",", "1"}], "]"}], "]"}], "<>", "\"\<mn\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"Round", "[", 
      RowBox[{"60", "*", 
       RowBox[{"(", 
        RowBox[{"eotmax", "-", 
         RowBox[{"Quotient", "[", 
          RowBox[{"eotmax", ",", "1"}], "]"}]}], ")"}]}], "]"}], "]"}], "<>", 
    "\"\<s\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eotmin", "=", 
   RowBox[{"N", "[", 
    RowBox[{"min", "*", "24", "*", "60", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"366", "/", "365"}], ")"}], "/", "360"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eotminms", "=", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"Quotient", "[", 
       RowBox[{"eotmin", ",", "1"}], "]"}]}], "]"}], "<>", "\"\<mn\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"-", "60"}], "*", 
       RowBox[{"(", 
        RowBox[{"eotmin", "-", "1", "-", 
         RowBox[{"Quotient", "[", 
          RowBox[{"eotmin", ",", "1"}], "]"}]}], ")"}]}], "]"}], "]"}], "<>", 
    "\"\<s\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"output", "=", 
  RowBox[{"Column", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Equation of Time - Extrema\>\"", ",", "14", ",", "Bold"}], 
        "]"}]}], ",", "\[IndentingNewLine]", "\"\<\\n\>\"", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Text", ",", "\[IndentingNewLine]", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"dmax", ",", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"max", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}], ",", "eotmaxms"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"dmin", ",", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"min", ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}], ",", "eotminms"}], "}"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "Bold"}], "]"}], "&"}], ")"}], "/@", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Date\>\"", ",", "\"\<True-Mean Sun Angle\>\"", ",", 
               "\"\<Equation of Time\>\""}], "}"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Dividers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"(*", 
             RowBox[{"2", "\[Rule]"}], "*)"}], 
            RowBox[{"{", "Black", "}"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Dividers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", "\[Rule]", "Black"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", "\[Rule]", "Black"}], "}"}]}], "}"}]}], ","}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"None", ",", "LightRed"}], "}"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.50", ",", "0.75"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "Center"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQnT9h7S/f7leOXxyOgWm5yzf+g+hprT5CfkD6w34G
KRAdNkEfTK83iVEC0S5LpdVBdNn9lsn+QPrQtKOrQLTOnJT1IJrDJ2g7iHZM
YtoHoieUTzwMog+cDL8LopkXez0E0fv2W7wA0ReWyEoGAOm0e1/kQbT53x5l
EC1S+VADRDNYMGuC6Glxd41BtI18hjmI3nTmijWIDrGq8wbRuwRrAkH0CvWj
YHpe179QEO277mkkiH7zcEsciBauX58JolPaa2tA9IeZCRNB9Plv36aBxXN2
zwPREUzvl4LNvftrFYjWUCvdDqL9y8L3gcX1GY6B6BpmPjAdEqHzEUQbRJd8
A9HL9a1/g+gzs+L/gWi9Xa+kAoH03fhMGRANAEzZwoo=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"name", "=", "\"\<tabEOT6\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
        RowBox[{"name", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", "output",
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ";"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.562702419060947*^9, 3.562702419460985*^9}, {
  3.5627025810025873`*^9, 3.562702687661881*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nbFourEOT", "[", "d_", "]"}], ":=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"graphEOT3DBis", "[", "d", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "380"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"2.0", "*", 
          RowBox[{"sphericalToCartesian", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "+", 
              RowBox[{"0", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "Pi", "*", 
                 RowBox[{"d", "/", "365"}]}], "]"}]}]}], ",", "d"}], "}"}], 
           "]"}]}]}], ","}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"3", "*", 
        RowBox[{"toTrueSun", "[", "d", "]"}]}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewVertical", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ViewAngle", "\[Rule]", 
       RowBox[{"22", "\[Degree]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
     RowBox[{"(*", 
      RowBox[{",", "\[IndentingNewLine]", 
       RowBox[{"Method", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<ShrinkWrap\>\"", "\[Rule]", "True"}], "}"}]}]}], "*)"}],
      "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.562859325819975*^9, 3.5628593274681797`*^9}, {
   3.5628594734146643`*^9, 3.5628594795416927`*^9}, {3.562860597833681*^9, 
   3.562860604135909*^9}, {3.562860642002005*^9, 3.562860704660253*^9}, {
   3.562860923161385*^9, 3.562860934340021*^9}, {3.562861026289481*^9, 
   3.562861093822823*^9}, {3.56286112837738*^9, 3.562861138759432*^9}, {
   3.562861203378026*^9, 3.5628612045439262`*^9}, {3.562861286008786*^9, 
   3.562861310737247*^9}, {3.5628621848816843`*^9, 3.562862185153273*^9}, {
   3.562862376454166*^9, 3.5628623851953506`*^9}, 3.562862872208267*^9, {
   3.56286566797891*^9, 3.5628657711313677`*^9}, 3.5628658716384907`*^9, {
   3.562870196662258*^9, 3.5628701967247343`*^9}, {3.562870345047969*^9, 
   3.562870346889902*^9}, {3.562870391190721*^9, 3.562870391278426*^9}, 
   3.562870626984921*^9, {3.562870872141697*^9, 3.562870926747793*^9}, 
   3.562870987780702*^9, {3.56287251773098*^9, 3.562872522698627*^9}, {
   3.562872723876925*^9, 3.562872724100479*^9}, {3.56287284190317*^9, 
   3.562872861000629*^9}, {3.5628729026162653`*^9, 3.562872903022479*^9}, {
   3.562873800482341*^9, 3.562873802367173*^9}, {3.562875121180635*^9, 
   3.562875157688386*^9}, {3.562875606121578*^9, 3.562875660577176*^9}, {
   3.562876435120537*^9, 3.562876435385128*^9}, {3.562876808380845*^9, 
   3.562876851428939*^9}, 3.562876913972432*^9, {3.5628769676149683`*^9, 
   3.56287698858881*^9}, {3.5628771718880444`*^9, 3.562877172646696*^9}, {
   3.5628774787712183`*^9, 3.562877479841379*^9}}],

Cell[BoxData[
 RowBox[{"output", "=", 
  RowBox[{"nbFourEOT", "[", "300", "]"}]}]], "Input",
 CellChangeTimes->{{3.562859487531636*^9, 3.562859488587647*^9}, {
   3.562859687638053*^9, 3.5628596878296547`*^9}, {3.5628607234014997`*^9, 
   3.5628607474559593`*^9}, {3.5628608202489243`*^9, 
   3.5628608205925903`*^9}, {3.562860949074211*^9, 3.562860949177659*^9}, {
   3.562861154124317*^9, 3.562861182004283*^9}, {3.5628612405824337`*^9, 
   3.562861279061117*^9}, {3.562861322237516*^9, 3.5628613476699057`*^9}, {
   3.562862137655057*^9, 3.562862178158022*^9}, {3.562862220711796*^9, 
   3.5628622673037777`*^9}, {3.5628623352499237`*^9, 3.562862341199815*^9}, 
   3.5628624343141336`*^9, {3.56286253467561*^9, 3.562862534735031*^9}, {
   3.562862624564004*^9, 3.562862643570718*^9}, {3.5628637214938927`*^9, 
   3.562863721548922*^9}, 3.5628650045724277`*^9, {3.562865089620171*^9, 
   3.562865102210348*^9}, {3.562865188677006*^9, 3.5628651887309713`*^9}, {
   3.562865560242112*^9, 3.562865567655376*^9}, {3.562866243087266*^9, 
   3.56286624330094*^9}, {3.562866534057619*^9, 3.562866534288145*^9}, {
   3.562866736612013*^9, 3.562866744523624*^9}, {3.562867998480721*^9, 
   3.562867998677541*^9}, 3.5628681025129766`*^9, {3.5628681612596292`*^9, 
   3.562868161935215*^9}, {3.562868240659587*^9, 3.5628682723286324`*^9}, {
   3.562868533164957*^9, 3.5628685502056217`*^9}, 3.5628685847324038`*^9, {
   3.562870334276692*^9, 3.562870385652463*^9}, {3.562870499389862*^9, 
   3.562870499453062*^9}, {3.5628705595038147`*^9, 3.562870559733635*^9}, {
   3.562870608382316*^9, 3.5628706088623123`*^9}, {3.562870640543151*^9, 
   3.562870656518537*^9}, {3.562870907825162*^9, 3.5628709078970203`*^9}, {
   3.562871002371892*^9, 3.562871034906245*^9}, 3.562872729002227*^9, {
   3.562876492631894*^9, 3.562876499718258*^9}, {3.562877956948091*^9, 
   3.562877959332045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nbFourEOT", "[", "d", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "45"}], "}"}], ",", "1", ",", "366", ",", "1"}], 
     "}"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.562872542026575*^9, 3.562872577377061*^9}, {
   3.562872968709984*^9, 3.562872973869347*^9}, {3.5628751287630053`*^9, 
   3.562875130169877*^9}, {3.562875167051296*^9, 3.562875169842249*^9}, 
   3.562876510678638*^9, 3.562877948846779*^9}],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"nbFourEOT", "[", "d", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "1", ",", "365", ",", "2"}], "}"}]}], "]"}]}], ";"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", "\"\<picEOTAnalemma\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
        RowBox[{"name", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", "output",
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", "0.08"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], 
     "*)"}], "]"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.562860782420353*^9, 3.562860803980197*^9}, {
   3.562870667968575*^9, 3.562870668055583*^9}, {3.562870817230051*^9, 
   3.56287081770564*^9}, 3.562871046876114*^9, {3.562871128373806*^9, 
   3.56287112878856*^9}, {3.562872929214759*^9, 3.562872950806657*^9}, {
   3.562872983015956*^9, 3.5628729865669613`*^9}, {3.562873069864881*^9, 
   3.56287307017546*^9}, {3.5628756944256773`*^9, 3.562875700960986*^9}, {
   3.562876949318453*^9, 3.562876952366585*^9}, 3.562877150625944*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Diagrams", "Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.5615719326120167`*^9, 3.5615719331289463`*^9}, {3.5617499879279737`*^9, 
  3.561749989944062*^9}, {3.562014244798807*^9, 3.562014262580276*^9}, {
  3.562015306710223*^9, 3.562015307238564*^9}, {3.5622294765641727`*^9, 
  3.562229478018215*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"radius", "=", "90"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"azimuthStep", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"altitudeStep", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circlePoint2D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", "Pi", " ", "t"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "Pi", " ", "t"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", 
       RowBox[{"1.0", "/", "360"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circlePoint3D", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"2", "Pi", " ", "t"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "Pi", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1", ",", 
       RowBox[{"1.0", "/", "360"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polarToCart2D", "[", "polarCoord_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "polarCoordSelect", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"polarCoordSelect", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"polarCoord", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            RowBox[{"-", "18"}]}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"polarCoordSelect", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"polarCoordSelect", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"90", "-", 
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"theta", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "\[Degree]"}], "]"}]}], 
          ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"90", "-", 
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"theta", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "\[Degree]"}], "]"}]}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "polarCoordSelect", "]"}]}], "}"}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polarToCart3D", "[", "polarCoord_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "polarCoordSelect", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"polarCoordSelect", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"polarCoord", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            RowBox[{"-", "18"}]}], ")"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{"polarCoordSelect", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"polarCoordSelect", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"N", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Degree]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"theta", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "\[Degree]"}], "]"}]}], 
           ",", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Degree]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"theta", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "\[Degree]"}], "]"}]}], 
           ",", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Degree]"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "polarCoordSelect", "]"}]}], "}"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointPolarToCart", "[", 
    RowBox[{"azimuth_", ",", "altitude_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"altitude", " ", "\[Degree]"}], "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"azimuth", " ", "\[Degree]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"altitude", " ", "\[Degree]"}], "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"azimuth", " ", "\[Degree]"}], "]"}]}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"altitude", " ", "\[Degree]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"latCircle", "[", "altitude_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"pointPolarToCart", "[", 
       RowBox[{"i", ",", "altitude"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "360"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"longCircle", "[", "azimuth_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"pointPolarToCart", "[", 
         RowBox[{"azimuth", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "18"}], ",", "80"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"pointPolarToCart", "[", 
         RowBox[{"azimuth", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100", ",", 
         RowBox[{"180", "+", "18"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allLatCircle", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Line", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"latCircle", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "90", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allLongCircle", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Line", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"longCircle", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "180", ",", "azimuthStep"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sunPath2D", "=", "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Gray", ",", "Dotted", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"altitudeStep", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}], ",", 
              RowBox[{"1.2", "*", "1.0", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}]}], "}"}], "]"}],
            "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"360", "\[Degree]"}], ",", 
            RowBox[{"azimuthStep", " ", "\[Degree]"}]}], "]"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.20", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}], ",", 
              RowBox[{"1.2", "*", "1.01", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}]}], "}"}], "]"}],
            "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"360", "\[Degree]"}], ",", 
            RowBox[{"1", "\[Degree]"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.20", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}], ",", 
              RowBox[{"1.2", "*", "1.02", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}]}], "}"}], "]"}],
            "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"360", "\[Degree]"}], ",", 
            RowBox[{"5", "\[Degree]"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.20", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}], ",", 
              RowBox[{"1.2", "*", "1.03", "*", "radius", "*", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "#", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "#", "]"}]}]}], "}"}]}]}], "}"}], "]"}],
            "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"360", "\[Degree]"}], ",", 
            RowBox[{"10", "\[Degree]"}]}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Gray", ",", "Dotted", ",", 
           RowBox[{"Circle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "#"}], "]"}]}], "}"}], 
         "&"}], "/@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "radius", ",", "altitudeStep"}], "]"}], ",", 
           RowBox[{"radius", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1.0", "+", 
               RowBox[{"6.0", "/", "90"}]}], ",", 
              RowBox[{"1.0", "+", 
               RowBox[{"12.0", "/", "90"}]}], ",", 
              RowBox[{"1.0", "+", 
               RowBox[{"18.0", "/", "90"}]}]}], "}"}]}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"Circle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "radius"}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"Round", "[", 
                 RowBox[{"#", "/", "Degree"}], "]"}], "]"}], "<>", 
               "\"\<\[Degree]\>\""}], ",", "Bold"}], "]"}], ",", 
            RowBox[{"1.11", "*", "1.2", "*", "radius", "*", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "#", "]"}], ",", 
               RowBox[{"Cos", "[", "#", "]"}]}], "}"}]}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"360", "\[Degree]"}], "-", 
            RowBox[{"azimuthStep", " ", "\[Degree]"}]}], ",", 
           RowBox[{"azimuthStep", " ", "\[Degree]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"Round", "[", 
                 RowBox[{"90", "-", "#"}], "]"}], "]"}], "<>", 
               "\"\<\[Degree]\>\""}], ",", "Bold"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "90", ",", "altitudeStep"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"90", "+", "6"}], ",", 
              RowBox[{"90", "+", "12"}], ",", 
              RowBox[{"90", "+", "18"}]}], "}"}]}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Text", "[", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "Bold", ",", "15"}], "]"}], ",", 
               RowBox[{"1.18", "*", "1.2", "*", "radius", "*", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
            "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<S\>\"", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<E\>\"", ",", 
              RowBox[{"90", "\[Degree]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<N\>\"", ",", 
              RowBox[{"180", "\[Degree]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<W\>\"", ",", 
              RowBox[{"270", "\[Degree]"}]}], "}"}]}], "}"}]}], "]"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Sun Altitude\>\"", ",", "12"}], "]"}], ",", 
           RowBox[{"90", "\[Degree]"}]}], "]"}], ",", 
         RowBox[{"radius", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.06"}], ",", 
            RowBox[{"1.0", "*", "0.85"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Sun Azimuth\>\"", ",", "12"}], "]"}], ",", 
           RowBox[{"0", "\[Degree]"}]}], "]"}], ",", 
         RowBox[{"radius", 
          RowBox[{"{", 
           RowBox[{"0.13", ",", 
            RowBox[{"1.18", "*", "1.06"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"city", "<>", "\"\<  Lat = \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"cityLat", ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}], "<>", 
            "\"\<\[Degree]\\n\>\""}], ",", "Bold", ",", "14", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}], ",", 
         RowBox[{"radius", 
          RowBox[{"{", 
           RowBox[{"0.0", ",", 
            RowBox[{"1.38", "*", "1.06"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.20", "]"}], ",", 
         RowBox[{"Lighter", "[", 
          RowBox[{"Blue", ",", "0.5"}], "]"}], ",", 
         RowBox[{"FilledCurve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"0.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"6.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.20", "]"}], ",", 
         RowBox[{"Lighter", "[", 
          RowBox[{"Blue", ",", "0.0"}], "]"}], ",", 
         RowBox[{"FilledCurve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"6.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"12.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.20", "]"}], ",", 
         RowBox[{"Darker", "[", 
          RowBox[{"Blue", ",", "0.5"}], "]"}], ",", 
         RowBox[{"FilledCurve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"12.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.0", "+", 
                RowBox[{"18.0", "/", "90"}]}], ")"}], "*", "radius", "*", 
              "circlePoint2D"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.0005", "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"polarToCart2D", "[", "t", "]"}], "]"}]}], "}"}], ","}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"Thickness", "[", "0.0015", "]"}], ",", 
           RowBox[{"Point", "[", 
            RowBox[{"polarToCart2D", "[", "t", "]"}], "]"}]}], "}"}], ","}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.0015", "]"}], ",", "Blue", ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Line", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"polarToCart2D", ",", 
             RowBox[{"allPath", "[", 
              RowBox[{"[", 
               RowBox[{"4", ";;", "9"}], "]"}], "]"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", 
         RowBox[{"Thickness", "[", "0.0015", "]"}], ",", "Blue", ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Line", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"polarToCart2D", ",", 
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{"allPath", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
               RowBox[{"allPath", "[", 
                RowBox[{"[", 
                 RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.001", "]"}], ",", 
         RowBox[{"Darker", "[", 
          RowBox[{"Green", ",", "0.25"}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Line", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"polarToCart2D", ",", "allAnalemma", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vp", "[", "t_", "]"}], ":=", 
    RowBox[{"1.15", "*", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "t", "]"}], ",", 
       RowBox[{"Sin", "[", "t", "]"}], ",", 
       RowBox[{"0.25", "-", 
        RowBox[{"0.0", "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"5", "t"}], "]"}]}]}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sunPath3D", "=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LightGray", ",", "Dashed", ",", "allLatCircle"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LightGray", ",", "Dashed", ",", "allLongCircle"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", "Dashed", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"longCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", "Dashed", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"longCircle", "[", "90", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Black", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"latCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LightGray", ",", "Dashed", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"latCircle", "[", 
            RowBox[{"-", "6"}], "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LightGray", ",", "Dashed", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"latCircle", "[", 
            RowBox[{"-", "12"}], "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"LightGray", ",", "Dashed", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"latCircle", "[", 
            RowBox[{"-", "18"}], "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Text", "@", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "Bold", ",", "Red"}], 
               "]"}]}], ",", 
             RowBox[{"1.2", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ")"}], "&"}], " ", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<N\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<E\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<S\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<W\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", "Blue", ",", 
          RowBox[{"Map", "[", 
           RowBox[{"Line", ",", 
            RowBox[{"Map", "[", 
             RowBox[{"polarToCart3D", ",", 
              RowBox[{"allPath", "[", 
               RowBox[{"[", 
                RowBox[{"4", ";;", "9"}], "]"}], "]"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", 
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", "Blue", ",", 
          RowBox[{"Map", "[", 
           RowBox[{"Line", ",", 
            RowBox[{"Map", "[", 
             RowBox[{"polarToCart3D", ",", 
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{"allPath", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
                RowBox[{"allPath", "[", 
                 RowBox[{"[", 
                  RowBox[{"10", ";;", "12"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
          RowBox[{"Darker", "[", 
           RowBox[{"Green", ",", "0.25"}], "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"Line", ",", 
            RowBox[{"Map", "[", 
             RowBox[{"polarToCart3D", ",", "allAnalemma", ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PreserveImageOptions", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "450"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"1.70", "*", "viewPoint"}]}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ViewAngle", "\[Rule]", 
       RowBox[{"28", "\[Degree]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"sunPath3D", ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"1.70", "*", 
        RowBox[{"vp", "[", "t", "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "0"}], "}"}], ",", "0", ",", 
      RowBox[{"2", " ", "Pi"}], ",", 
      RowBox[{"0.05", " ", "Pi"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.561923443523693*^9, 3.561923479392734*^9}, {
   3.561923531721446*^9, 3.561923562674823*^9}, {3.56192365374095*^9, 
   3.561923704499205*^9}, {3.5619237448135757`*^9, 3.561923750227746*^9}, {
   3.561923815820771*^9, 3.5619238204673777`*^9}, {3.561923854756374*^9, 
   3.561923861388322*^9}, {3.561923899325451*^9, 3.561923952389688*^9}, {
   3.561924003471418*^9, 3.561924145174572*^9}, {3.561924186777327*^9, 
   3.561924347536824*^9}, 3.5619245053299847`*^9, {3.561924536476812*^9, 
   3.561924542568965*^9}, {3.56192459469118*^9, 3.5619245951087933`*^9}, {
   3.561924631539545*^9, 3.561924719315983*^9}, {3.561924758836851*^9, 
   3.561925261282609*^9}, {3.561925331973138*^9, 3.561925346634305*^9}, {
   3.56192539033193*^9, 3.561925597701974*^9}, {3.561925650959918*^9, 
   3.561925651614418*^9}, {3.561925706386795*^9, 3.561925745767461*^9}, {
   3.5619257784640923`*^9, 3.561925898385735*^9}, {3.561926214744443*^9, 
   3.5619263477030478`*^9}, {3.561926392061492*^9, 3.561926402400056*^9}, {
   3.561926451473824*^9, 3.5619264718641233`*^9}, {3.561926516716324*^9, 
   3.561926529190071*^9}, {3.561926582882595*^9, 3.5619266008547907`*^9}, {
   3.561926714038011*^9, 3.5619267421494627`*^9}, {3.5619268154364634`*^9, 
   3.561926820955234*^9}, {3.561926906382863*^9, 3.561926975012855*^9}, {
   3.561927960129386*^9, 3.561927998349629*^9}, {3.5619280335103703`*^9, 
   3.561928050574379*^9}, {3.561928462560946*^9, 3.561928562861412*^9}, {
   3.561928599177458*^9, 3.5619289330040207`*^9}, {3.561928969413085*^9, 
   3.561929041381625*^9}, {3.5619290756367483`*^9, 3.561929189745719*^9}, {
   3.561929694856715*^9, 3.561929747574396*^9}, {3.5619297972814293`*^9, 
   3.56192992344907*^9}, {3.561930023022018*^9, 3.561930050541947*^9}, {
   3.561930153704083*^9, 3.5619301765014677`*^9}, {3.561930289450375*^9, 
   3.561930392305285*^9}, {3.561930428609331*^9, 3.561930473977188*^9}, {
   3.561930628130916*^9, 3.561930629971121*^9}, {3.561930677395303*^9, 
   3.561930678267721*^9}, 3.561930851504621*^9, {3.561930884104207*^9, 
   3.561930966518614*^9}, {3.5619310447040167`*^9, 3.561931101766568*^9}, {
   3.5619311381610403`*^9, 3.561931153624894*^9}, {3.561931183885096*^9, 
   3.561931186313367*^9}, {3.5619312253867702`*^9, 3.5619312636658154`*^9}, {
   3.561931580568379*^9, 3.5619315966674633`*^9}, {3.5619317801495457`*^9, 
   3.5619317839707537`*^9}, {3.561931824523284*^9, 3.5619318785164623`*^9}, {
   3.561931960600314*^9, 3.56193196928794*^9}, {3.561932032139702*^9, 
   3.5619320326286488`*^9}, {3.5619321080579023`*^9, 3.561932213159573*^9}, {
   3.561932418585614*^9, 3.561932425879464*^9}, {3.5619325822886133`*^9, 
   3.5619327201545*^9}, {3.5619328615182877`*^9, 3.561932863139617*^9}, {
   3.561933051061493*^9, 3.561933068044468*^9}, {3.5619333005412483`*^9, 
   3.561933305948889*^9}, {3.562001465830304*^9, 3.5620014692525177`*^9}, {
   3.562001680951919*^9, 3.56200171982508*^9}, {3.562001796962556*^9, 
   3.5620018025035343`*^9}, {3.5620019902364902`*^9, 3.562002036650741*^9}, {
   3.562002096244287*^9, 3.5620021480583076`*^9}, {3.562002185790164*^9, 
   3.5620022044442463`*^9}, {3.562002264469318*^9, 3.5620022840059557`*^9}, {
   3.562002314859283*^9, 3.562002400962916*^9}, 3.562002460305388*^9, {
   3.562003112057167*^9, 3.562003112726119*^9}, {3.56200523749679*^9, 
   3.562005241272896*^9}, {3.562006037060299*^9, 3.562006037172962*^9}, 
   3.56200608426864*^9, {3.562007606043488*^9, 3.5620076108366623`*^9}, {
   3.562011182086523*^9, 3.562011182346343*^9}, {3.562012048670268*^9, 
   3.562012076132823*^9}, {3.5620121138746147`*^9, 3.562012187000683*^9}, {
   3.562012279691271*^9, 3.562012352772532*^9}, {3.562012387199293*^9, 
   3.5620123898915043`*^9}, {3.562012458031775*^9, 3.5620125828482637`*^9}, {
   3.562012614298458*^9, 3.5620126368762283`*^9}, {3.562012673386992*^9, 
   3.562012714478784*^9}, {3.5620127548350687`*^9, 3.562012754957739*^9}, 
   3.562015843633354*^9, 3.5620159895556717`*^9, {3.56201602665836*^9, 
   3.562016029396072*^9}, {3.562016675822029*^9, 3.562016740456985*^9}, {
   3.562016776163225*^9, 3.562016786520389*^9}, {3.5620168531488867`*^9, 
   3.562016898483779*^9}, {3.562016945523541*^9, 3.5620169537239847`*^9}, {
   3.562017088114502*^9, 3.562017097294277*^9}, {3.562017131744734*^9, 
   3.562017235814724*^9}, {3.562017867683154*^9, 3.562017903465144*^9}, {
   3.562093601494084*^9, 3.562093635126124*^9}, {3.56209373551259*^9, 
   3.5620937436631317`*^9}, {3.562093806652269*^9, 3.562093832850869*^9}, {
   3.562093886472622*^9, 3.56209388730099*^9}, {3.562094259034773*^9, 
   3.5620943135375032`*^9}, {3.562094461428094*^9, 3.562094462339704*^9}, 
   3.5620947453888474`*^9, 3.562094782446128*^9, {3.5620948797295437`*^9, 
   3.562094933316613*^9}, {3.562094978408826*^9, 3.562094999065753*^9}, {
   3.5620953276991673`*^9, 3.562095345064817*^9}, {3.562095528697715*^9, 
   3.5620955621278048`*^9}, 3.562095713491467*^9, {3.5620957832938757`*^9, 
   3.5620958253722553`*^9}, {3.562095946406178*^9, 3.562095947768366*^9}, {
   3.5620962289593077`*^9, 3.5620962629466467`*^9}, {3.562096456361207*^9, 
   3.562096485547036*^9}, {3.562096728447789*^9, 3.562096777278722*^9}, {
   3.5620968230412607`*^9, 3.5620968823751163`*^9}, {3.562096947757278*^9, 
   3.562097006819813*^9}, 3.562097060388506*^9, 3.562097121282655*^9, {
   3.562097177795483*^9, 3.562097223859661*^9}, {3.562097290697425*^9, 
   3.5620974029283123`*^9}, {3.5620974351107283`*^9, 3.562097437740856*^9}, {
   3.5620975127725677`*^9, 3.562097547935111*^9}, {3.562097619414323*^9, 
   3.562097681335786*^9}, {3.562097711710329*^9, 3.562097742436941*^9}, {
   3.562097827766966*^9, 3.562097829762434*^9}, {3.562097889125519*^9, 
   3.562097944325639*^9}, {3.562097990573914*^9, 3.5620980011498537`*^9}, {
   3.562098033147587*^9, 3.562098148125473*^9}, {3.562098196350316*^9, 
   3.562098256897312*^9}, {3.562106474886456*^9, 3.5621065040739193`*^9}, {
   3.5621065463608847`*^9, 3.56210662757084*^9}, {3.562106800013936*^9, 
   3.5621068726576433`*^9}, 3.562252845301573*^9, {3.562253353101336*^9, 
   3.562253375914667*^9}, {3.562253565749433*^9, 3.562253582864772*^9}, {
   3.562256200083437*^9, 3.562256245762548*^9}, {3.562256311360277*^9, 
   3.562256340835806*^9}, {3.562271010863904*^9, 3.562271012536191*^9}, {
   3.562358948504033*^9, 3.562358950863402*^9}, {3.562704528435763*^9, 
   3.5627045289797688`*^9}, 3.562705114558962*^9, 3.5627051657357616`*^9, {
   3.562705278884487*^9, 3.56270531170018*^9}, {3.5627053481338053`*^9, 
   3.562705445912776*^9}, {3.5627054901260653`*^9, 3.5627057129513083`*^9}, {
   3.562705759046051*^9, 3.562705796688089*^9}, {3.562705840288834*^9, 
   3.5627058408082848`*^9}, {3.5627058810336313`*^9, 3.562705979076486*^9}, {
   3.56270601303588*^9, 3.562706042389844*^9}, {3.562706100533462*^9, 
   3.5627061994960947`*^9}, {3.5627062297660427`*^9, 3.562706257679406*^9}, {
   3.562706295194149*^9, 3.562706425694591*^9}, {3.562706475103619*^9, 
   3.562706494574109*^9}, {3.562706715988139*^9, 3.5627067174737673`*^9}, {
   3.562706780183268*^9, 3.56270678034901*^9}, {3.562706812629857*^9, 
   3.5627069119036493`*^9}, {3.562706954006056*^9, 3.562706982277937*^9}, 
   3.562707025841399*^9, {3.5627070601891127`*^9, 3.5627070789018784`*^9}, {
   3.562707125157762*^9, 3.562707155539928*^9}, {3.562707188677135*^9, 
   3.562707191341296*^9}, {3.562707240141486*^9, 3.562707248589899*^9}, {
   3.5628473592636213`*^9, 3.562847376732995*^9}, {3.562847719710123*^9, 
   3.562847756795844*^9}, 3.562847810849019*^9, 3.562847851593248*^9, 
   3.562848502096764*^9, {3.562871837527423*^9, 3.562871883524864*^9}, {
   3.562871927184607*^9, 3.5628719334241657`*^9}, {3.562871973966982*^9, 
   3.5628720911607103`*^9}, 3.562953097103325*^9, {3.5629595908258142`*^9, 
   3.562959591126349*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"\"\<picSunPath2D_\>\"", "<>", "city"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
        RowBox[{"name", "<>", "\"\<.png\>\""}]}], "}"}], "]"}], ",", 
     "sunPath2D", ",", "\"\<PNG\>\"", ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ";"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.56284710760462*^9, 3.562847173741354*^9}}],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"sunPath3D", ",", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"1.70", "*", 
          RowBox[{"vp", "[", "t", "]"}]}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", 
        RowBox[{"2", " ", "Pi"}], ",", 
        RowBox[{"2", "*", 
         RowBox[{"Pi", "/", "360"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"\"\<picSunPath3D_\>\"", "<>", "city"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
        RowBox[{"name", "<>", "\"\<.gif\>\""}]}], "}"}], "]"}], ",", "output",
      ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", "0.08"}], ",", 
     RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], "]"}],
    ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.562847217502441*^9, 3.562847231030218*^9}, {
   3.56284726240135*^9, 3.562847349432302*^9}, 3.562848580273391*^9, 
   3.562871897305448*^9, 3.562872103688921*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pointPolarToCart", "[", 
    RowBox[{"azimuth_", ",", "altitude_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"altitude", " ", "\[Degree]"}], "]"}], "*", 
      RowBox[{"Sin", "[", 
       RowBox[{"azimuth", " ", "\[Degree]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"altitude", " ", "\[Degree]"}], "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"azimuth", " ", "\[Degree]"}], "]"}]}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{"altitude", " ", "\[Degree]"}], "]"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"latCircle", "[", "altitude_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"pointPolarToCart", "[", 
       RowBox[{"i", ",", "altitude"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "360"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"longCircle", "[", "azimuth_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"pointPolarToCart", "[", 
         RowBox[{"azimuth", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "18"}], ",", "80"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"N", "@", 
        RowBox[{"pointPolarToCart", "[", 
         RowBox[{"azimuth", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "100", ",", 
         RowBox[{"180", "+", "18"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allLatCircle", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Line", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"latCircle", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "90", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allLongCircle", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Line", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"longCircle", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "180", ",", "10"}], "}"}]}], "]"}], ",", 
      
      RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"displaySimpleSunPath3D", "[", 
    RowBox[{"lat_", ",", "date_", ",", "t_", ",", "riseset_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "tilt", ",", "zenithToAxis", ",", "d", ",", "coneBaseUnit", 
       ",", "coneAngle", ",", "coneRadius", ",", "coneBase", ",", "sunCone", 
       ",", "groundPlane", ",", "sol", ",", "sunrise", ",", "sunset", ",", 
       "sunsetAngle", ",", "angleChampsElysees", ",", "axisChampsElysees", 
       ",", "simpleSunPath3D"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tilt", "=", "23.45"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zenithToAxis", "=", 
       RowBox[{"90", "-", "lat"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"date", "=", 
         RowBox[{"{", 
          RowBox[{"2013", ",", "9", ",", "11"}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"5", " ", "aug"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"7", " ", "may"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"DateDifference", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2012", ",", "6", ",", "21"}], "}"}], ",", "date"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coneBaseUnit", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"N", "@", 
          RowBox[{"Sin", "[", 
           RowBox[{"zenithToAxis", " ", "\[Degree]"}], "]"}]}], ",", 
         RowBox[{"N", "@", 
          RowBox[{"Cos", "[", 
           RowBox[{"zenithToAxis", " ", "\[Degree]"}], "]"}]}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"coneAngle", "=", 
       RowBox[{"90", "-", 
        RowBox[{"tilt", "*", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", "Pi", " ", 
           RowBox[{"d", "/", "365"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"90", "\[Degree]"}], "-", 
        RowBox[{"EarthTilt\[Degree]", " ", "Cos", 
         RowBox[{"(", 
          RowBox[{"2", "\[Pi]", " ", 
           FractionBox["d", "365"]}], ")"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"coneAngle", "\[NotEqual]", "90"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coneRadius", "=", 
          RowBox[{"N", "@", 
           RowBox[{"Sin", "[", 
            RowBox[{"coneAngle", " ", "\[Degree]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coneBase", "=", 
          RowBox[{
           RowBox[{"N", "@", 
            RowBox[{"Cos", "[", 
             RowBox[{"coneAngle", " ", "\[Degree]"}], "]"}]}], "*", 
           "coneBaseUnit"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coneRadius", "=", "1.0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"coneBase", "=", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sunCone", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coneBase", "\[NotEqual]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"Cone", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"coneBase", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
           "coneRadius"}], "]"}], ",", 
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"Polygon", "[", 
            RowBox[{"latCircle", "[", "0", "]"}], "]"}], ",", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"90", "-", "lat"}], ")"}], "\[Degree]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"groundPlane", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"i", " ", "\[Degree]"}], "]"}], ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"i", " ", "\[Degree]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "360"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "0"}], "}"}], ".", "coneBaseUnit"}], 
           "\[Equal]", 
           RowBox[{"Cos", "[", 
            RowBox[{"coneAngle", " ", "\[Degree]"}], "]"}]}], " ", "&&", " ", 
          
          RowBox[{
           RowBox[{
            RowBox[{"x", "^", "2"}], "+", 
            RowBox[{"y", "^", "2"}]}], "\[Equal]", "1"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "Reals"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sunrise", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "0"}], "}"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sunset", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "0"}], "}"}], "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sunsetAngle", "=", 
       RowBox[{
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"sol", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}], "/", 
          RowBox[{"Abs", "[", 
           RowBox[{"sol", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}], 
        "*", 
        RowBox[{"360", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "Pi"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"angleChampsElysees", "=", "26"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"riseset", "\[Equal]", "\"\<sunrise\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"axisChampsElysees", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"+", 
              RowBox[{"Cos", "[", 
               RowBox[{"angleChampsElysees", " ", "\[Degree]"}], "]"}]}], ",", 
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               RowBox[{"angleChampsElysees", " ", "\[Degree]"}], "]"}]}], ",",
              "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"axisChampsElysees", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"angleChampsElysees", " ", "\[Degree]"}], "]"}]}], 
              ",", 
              RowBox[{"Sin", "[", 
               RowBox[{"angleChampsElysees", " ", "\[Degree]"}], "]"}], ",", 
              "0"}], "}"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"simpleSunPath3D", "=", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "Dashed", ",", "allLatCircle"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "Dashed", ",", "allLongCircle"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"longCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"longCircle", "[", "90", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"latCircle", "[", "0", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"latCircle", "[", 
               RowBox[{"-", "6"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"latCircle", "[", 
               RowBox[{"-", "12"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LightGray", ",", "Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"latCircle", "[", 
               RowBox[{"-", "18"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Inset", "[", 
               RowBox[{
                RowBox[{"Text", "@", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Bold", ",", "Red"}],
                   "]"}]}], ",", 
                RowBox[{"1.2", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ")"}], "&"}], 
            " ", "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<N\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<S\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<W\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Black", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                "coneBaseUnit"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.1", "]"}], ",", "Orange", ",", 
             "sunCone"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.1", "]"}], ",", "Blue", ",", 
             RowBox[{"Polygon", "[", "groundPlane", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "sunrise"}], 
               "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "sunset"}], 
               "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Orange", ",", 
             RowBox[{"Line", "[", "axisChampsElysees", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PreserveImageOptions", "\[Rule]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ViewPoint", "\[Rule]", 
           RowBox[{"1.70", "*", 
            RowBox[{"pointPolarToCart", "[", 
             RowBox[{"azi", ",", "alt"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ViewAngle", "\[Rule]", 
           RowBox[{"Dynamic", "[", 
            RowBox[{"32", "\[Degree]"}], "]"}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"RotationTransform", "[", 
         RowBox[{"t", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"4.5", "*", 
         RowBox[{"{", 
          RowBox[{"0.8", ",", 
           RowBox[{"-", "0.2"}], ",", "0.35"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"riseset", "\[Equal]", "\"\<sunrise\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<Sunrise Angle = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"90", "-", "sunsetAngle"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}], ",", "Bold", ",", "14"}], "]"}], 
              "]"}], ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Text", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<Sunset Angle = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{"270", "+", "sunsetAngle"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "]"}], "]"}], "<>", 
                 "\"\<\[Degree]\>\""}], ",", "Bold", ",", "14"}], "]"}], 
              "]"}], ",", "SpanFromLeft"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Champs Elys\[EAcute]es Axis = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"riseset", "\[Equal]", "\"\<sunrise\>\""}], ",", 
                   "90", ",", "270"}], "]"}], "+", "26"}], "]"}], "<>", 
               "\"\<\[Degree]\>\""}], ",", "Bold", ",", "14"}], "]"}], "]"}], 
           ",", "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<Day = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"DateString", "[", 
                 RowBox[{
                  RowBox[{"DatePlus", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "2012", ",", "6", ",", "21", ",", "0", ",", "0", ",", 
                    "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"d", ",", "\"\<Day\>\""}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Day\>\"", ",", "\"\< \>\"", ",", 
                    "\"\<MonthName\>\""}], "}"}]}], "]"}], "]"}]}], ",", 
              "Bold", ",", "14"}], "]"}], "]"}], ",", "SpanFromLeft"}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Show", "[", 
           RowBox[{"simpleSunPath3D", ",", "\[IndentingNewLine]", 
            RowBox[{"ViewPoint", "\[Rule]", "v"}], ",", 
            RowBox[{"ViewAngle", "\[Rule]", 
             RowBox[{"14", "\[Degree]"}]}], ",", 
            RowBox[{"ViewVertical", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
            RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}]}], "]"}], 
          "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.562533811023731*^9, 3.562533824990003*^9}, {
   3.562534030069747*^9, 3.562534046939777*^9}, {3.56253440530643*^9, 
   3.5625344083227577`*^9}, 3.562534500045484*^9, {3.562534543001206*^9, 
   3.562534595777195*^9}, {3.56253474279113*^9, 3.562534742987823*^9}, 
   3.562534779101741*^9, {3.562534940197719*^9, 3.562535038912986*^9}, {
   3.5625350931811113`*^9, 3.562535103625705*^9}, {3.562535740364232*^9, 
   3.56253581439823*^9}, {3.562535896400226*^9, 3.56253592726239*^9}, {
   3.562536391307909*^9, 3.5625364140144587`*^9}, {3.562536488644948*^9, 
   3.562536557133793*^9}, {3.56253664184031*^9, 3.562536810838297*^9}, {
   3.562536843705986*^9, 3.562536866530383*^9}, {3.562536899547964*^9, 
   3.562536902338108*^9}, {3.562536979558024*^9, 3.5625370199074373`*^9}, {
   3.562537128702794*^9, 3.5625371580495663`*^9}, {3.562537241990386*^9, 
   3.562537243053217*^9}, {3.562537295189273*^9, 3.562537320421118*^9}, {
   3.562537390169056*^9, 3.562537430579576*^9}, 3.5625374864401293`*^9, {
   3.5625375180250797`*^9, 3.5625375639370613`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dateInput", "=", 
   RowBox[{"{", 
    RowBox[{"2012", ",", "8", ",", "5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"output", "=", 
  RowBox[{"displaySimpleSunPath3D", "[", 
   RowBox[{"48.83", ",", "dateInput", ",", 
    RowBox[{
     RowBox[{"+", "0.0"}], "*", "2", " ", "Pi"}], ",", "\"\<sunset\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"name", "=", 
   RowBox[{"\"\<simpleSunPath3D-\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"dateInput", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"dateInput", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"repoDir", ",", "\"\<Pictures\>\"", ",", 
       RowBox[{"name", "<>", "\"\<.png\>\""}]}], "}"}], "]"}], ",", "output", 
    ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5625325978912992`*^9, 3.562532614146289*^9}, {
   3.562532815141453*^9, 3.562532859669874*^9}, {3.562533306322254*^9, 
   3.562533364770707*^9}, {3.562533399538631*^9, 3.5625334840790787`*^9}, {
   3.5625335173093147`*^9, 3.5625335962857037`*^9}, {3.562534605048777*^9, 
   3.5625346477602053`*^9}, {3.562535833716873*^9, 3.562535842873321*^9}, {
   3.5625359416538277`*^9, 3.562535965676552*^9}, {3.56253631456819*^9, 
   3.562536365288671*^9}, {3.5625364449853783`*^9, 3.5625364549874487`*^9}, 
   3.562536570786582*^9, {3.5625366196751137`*^9, 3.562536629335824*^9}, {
   3.562537193272801*^9, 3.562537193496203*^9}, {3.562537448347179*^9, 
   3.56253744864284*^9}, 3.562537504653404*^9, {3.562537583148529*^9, 
   3.5625375934104967`*^9}, {3.562537671925441*^9, 3.562537682621016*^9}, {
   3.5625377226374807`*^9, 3.562537776767296*^9}, {3.562603093885563*^9, 
   3.562603100636601*^9}, {3.562603141452931*^9, 3.562603174965267*^9}, {
   3.5626032557501802`*^9, 3.5626032635421333`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Test zone", "Subsection"]], "Subsubsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.560368448893894*^9, 3.560368451069151*^9}, {
  3.561571937865049*^9, 3.5615719382651587`*^9}, {3.56201313983422*^9, 
  3.5620131419218407`*^9}, {3.562013240274948*^9, 3.5620132429946423`*^9}, {
  3.562014071596483*^9, 3.5620140801229763`*^9}, {3.562014126588818*^9, 
  3.562014173620092*^9}, {3.5620142684046183`*^9, 3.562014278804381*^9}, {
  3.5626844913705873`*^9, 3.562684494794379*^9}, {3.56269980612395*^9, 
  3.562699806490673*^9}}],

Cell[BoxData[{
 RowBox[{"a", "=", 
  RowBox[{"r", " ", "sin", 
   RowBox[{"(", "m", ")"}]}]}], "\n", 
 RowBox[{"b", "=", 
  RowBox[{"r", " ", "cos", 
   RowBox[{"(", "m", ")"}]}]}], "\n", 
 RowBox[{"c", "=", 
  RowBox[{"r", " ", "cos", 
   RowBox[{"(", "tilt", ")"}], " ", "sin", 
   RowBox[{"(", "m", ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{"tan", 
   RowBox[{"(", "t", ")"}]}], "=", 
  RowBox[{
   RowBox[{"c", "/", "b"}], "=", 
   RowBox[{"cos", 
    RowBox[{"(", "tilt", ")"}], " ", "tan", 
    RowBox[{"(", "m", ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tan", 
   RowBox[{"(", "t", ")"}]}], "=", 
  RowBox[{
   RowBox[{"cos", 
    RowBox[{"(", "tilt", ")"}], " ", "tan", 
    RowBox[{"(", "m", ")"}], "  ", "for", " ", "0"}], "<", "t", "<", 
   "90"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tan", 
   RowBox[{"(", "t", ")"}]}], "=", 
  RowBox[{
   RowBox[{"180", "+", 
    RowBox[{"cos", 
     RowBox[{"(", "tilt", ")"}], " ", "tan", 
     RowBox[{"(", "m", ")"}], "  ", "for", " ", "90"}]}], "<", "t", "<", 
   "270"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tan", 
   RowBox[{"(", "t", ")"}]}], "=", 
  RowBox[{
   RowBox[{"360", "+", 
    RowBox[{"cos", 
     RowBox[{"(", "tilt", ")"}], " ", "tan", 
     RowBox[{"(", "m", ")"}], "  ", "for", " ", "270"}]}], "<", "t", "<", 
   "360"}]}], "\[IndentingNewLine]", 
 RowBox[{"90", "\[Degree]"}]}], "Input",
 CellChangeTimes->{{3.562684638131579*^9, 3.562684638133327*^9}, {
   3.562684850471665*^9, 3.562684851211637*^9}, {3.562684901007784*^9, 
   3.5626849626194143`*^9}, {3.56268590927169*^9, 3.562685913705408*^9}, {
   3.562687078509687*^9, 3.562687084939702*^9}, 3.562688147769434*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"23.45", "\[Degree]"}], "]"}], 
      RowBox[{"Tan", "[", 
       RowBox[{"t", "*", "2", " ", 
        RowBox[{"Pi", "/", "360"}]}], "]"}]}], "]"}], "*", 
    RowBox[{"360", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "Pi"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", 
  RowBox[{"{", 
   RowBox[{
   "10", ",", "80", ",", "100", ",", "170", ",", "190", ",", "260", ",", 
    "280", ",", "350"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.562619669495707*^9, 3.5626197241432333`*^9}, {
  3.562619755791388*^9, 3.562619761224078*^9}, {3.562688129349654*^9, 
  3.5626881296468143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "i", "]"}], "-", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "90", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.562689249817912*^9, 3.562689302016284*^9}, {
  3.562689337769269*^9, 3.562689338184424*^9}}],

Cell[BoxData[{
 RowBox[{"Max", "[", "test", "]"}], "\[IndentingNewLine]", 
 RowBox[{"t", "=", 
  RowBox[{"-", 
   RowBox[{"Min", "[", "test", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.5626892873489313`*^9, 3.562689289999777*^9}, {
  3.562689354715453*^9, 3.5626893590563097`*^9}, {3.562691999513554*^9, 
  3.5626920003771887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"366", "/", "365"}], ")"}], "*", 
   RowBox[{"360", "/", 
    RowBox[{"(", 
     RowBox[{"24", "*", "60"}], ")"}]}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.562690485728696*^9, 3.562690522651472*^9}}],

Cell[BoxData[
 RowBox[{"t", "*", "24", "*", 
  RowBox[{"60", "/", "360"}], "*", 
  RowBox[{"(", 
   RowBox[{"366", "/", "365"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.562690526066877*^9, 3.562690526725898*^9}, {
  3.56269193899256*^9, 3.562692005753462*^9}}],

Cell[BoxData[
 RowBox[{"0.9", "*", "60"}]], "Input",
 CellChangeTimes->{{3.5626920291965227`*^9, 3.5626920305767803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "formula", " ", "is", " ", "the", " ", "angular", " ", "speed", " ", "in", 
    " ", "degree", " ", "per", " ", "day"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"e", "=", "0.0167"}], "\[IndentingNewLine]", 
   RowBox[{"T", "=", 
    RowBox[{
     RowBox[{"365", "+", 
      FractionBox["1", "4"], "-", 
      FractionBox["1", "100"], "+", 
      FractionBox["1", "400"]}], "=", "365.2425"}]}], "\[IndentingNewLine]", 
   RowBox[{"M", "=", 
    RowBox[{
     FractionBox["t", "T"], "360", "\[Degree]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SunAngularSpeed", 
     RowBox[{"(", "t", ")"}]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"360", "\[Degree]"}], "T"], "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", "e", " ", 
        RowBox[{"Cos", "[", "M", "]"}]}], "+", 
       RowBox[{
        FractionBox["5", "2"], 
        SuperscriptBox["e", "2"], 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "M"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["e", "3"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "4"]}], 
           RowBox[{"Cos", "[", "M", "]"}]}], "+", 
          RowBox[{
           FractionBox["13", "4"], 
           RowBox[{"Cos", "[", 
            RowBox[{"3", "M"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]}]}]], "Input",\

 CellChangeTimes->{{3.562692210987061*^9, 3.562692321672852*^9}, 
   3.56269235988666*^9, {3.562692610738381*^9, 3.562692627857685*^9}, {
   3.5626926818459272`*^9, 3.5626927070583763`*^9}, {3.562694077335102*^9, 
   3.562694096697084*^9}, {3.562699815030983*^9, 3.56269981715867*^9}}],

Cell[BoxData[
 RowBox[{"NumberForm", "[", 
  RowBox[{
   RowBox[{"365.", "+", 
    FractionBox["1", "4"], "-", 
    FractionBox["1", "100"], "+", 
    FractionBox["1", "400"]}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.562692718671736*^9, 3.562692817305016*^9}, {
  3.562692851026032*^9, 3.5626928752495623`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gregorianYear", "=", 
   RowBox[{"365.", "+", 
    RowBox[{"1", "/", "4"}], "-", 
    RowBox[{"1", "/", "100"}], "+", 
    RowBox[{"1", "/", "400"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"show", "[", "nb_", "]"}], ":=", 
   RowBox[{"NumberForm", "[", 
    RowBox[{"nb", ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "8"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yearDuration", "[", "T_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"365.2421896698", "\[Minus]", 
      RowBox[{"6.15359", "*", 
       SuperscriptBox["10", 
        RowBox[{"\[Minus]", "6"}]], "T"}]}], "\[Minus]", 
     RowBox[{"7.29", "*", 
      SuperscriptBox["10", 
       RowBox[{"\[Minus]", "10"}]], 
      RowBox[{"T", "^", "2"}]}]}], "+", 
    RowBox[{"2.64", "*", 
     SuperscriptBox["10", 
      RowBox[{"\[Minus]", "10"}]], "*", 
     RowBox[{"T", "^", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"offset", "[", "n_", "]"}], ":=", 
  RowBox[{"Total", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"yearDuration", "[", 
        RowBox[{"i", "/", "100"}], "]"}], "-", "gregorianYear"}], ")"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"show", "@", "gregorianYear"}], "\[IndentingNewLine]", 
 RowBox[{"show", "@", 
  RowBox[{"yearDuration", "[", 
   RowBox[{"n", "/", "100"}], "]"}]}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Export NB to GitHub local repo",
 FontSize->14]], "Subsection",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.555692369900028*^9, 3.555692380130302*^9}, {
   3.555692430844801*^9, 3.5556924449312153`*^9}, {3.5556975322898693`*^9, 
   3.555697544343995*^9}, {3.555698692266656*^9, 3.555698698674325*^9}, 
   3.55586019273463*^9, 3.55586029194726*^9, 3.555860329557722*^9, 
   3.555860395309059*^9, 3.5558612198172007`*^9, {3.555862546003208*^9, 
   3.555862549555197*^9}, {3.5558626587253513`*^9, 3.555862668925728*^9}, {
   3.5594109639537*^9, 3.5594109755697412`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"NotebookEventActions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<WindowClose\>\"", "\[RuleDelayed]", 
        RowBox[{"FrontEndExecute", "[", 
         RowBox[{"FrontEndToken", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
         "]"}]}], "}"}]}]}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.555700085084764*^9, 3.555700085088874*^9}, 
   3.555700438198511*^9, 3.555860192734806*^9, 3.555860291947433*^9, 
   3.5558603295578938`*^9, 3.555860395309334*^9, 3.555861219817484*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.556125998003141*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"name", "=", "\"\<sunMotion-AllInOne\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repoDir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
     "$InitialDirectory", ",", "\"\<Dropbox\>\"", ",", "\"\<Archives\>\"", 
      ",", "\"\<GitHub\>\"", ",", "\"\<SunMotion\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"SelectedNotebook", "[", "]"}], ",", 
    RowBox[{"PrivateNotebookOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "]"}], ";", 
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"repoDir", ",", "\"\<NB\>\"", ",", 
       RowBox[{"name", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}], ",", 
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\"\<NB\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"SelectedNotebook", "[", "]"}], ",", 
    RowBox[{"PrivateNotebookOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "Automatic"}], "}"}]}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5558625781088457`*^9, {3.555862679725438*^9, 3.555862680582274*^9}, 
   3.555862713160735*^9, {3.5558627502472067`*^9, 3.555862754359941*^9}, {
   3.555862788705677*^9, 3.555862816912328*^9}, {3.555862892514326*^9, 
   3.555862893056941*^9}, {3.5558660250375566`*^9, 3.555866028085747*^9}, {
   3.555866132711671*^9, 3.55586615131142*^9}, {3.555866291282649*^9, 
   3.5558662940895767`*^9}, 3.555866341499641*^9, 3.555950287402473*^9, {
   3.555950453957109*^9, 3.555950516765461*^9}, {3.555950762712882*^9, 
   3.555950766496972*^9}, {3.5561259904121037`*^9, 3.5561260192259607`*^9}, {
   3.5594110396714163`*^9, 3.559411117414361*^9}, {3.562877919447382*^9, 
   3.562877920998171*^9}, {3.562959620723567*^9, 3.562959627905175*^9}}]
}, Open  ]]
},
Evaluator->"LocalBG",
WindowSize->{1271, 1246},
WindowMargins->{{Automatic, 327}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
CellContext->Notebook,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (August 26, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 400, 11, 70, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[982, 35, 469, 7, 70, "Subsubsection"],
Cell[1454, 44, 22180, 490, 70, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23671, 539, 214, 3, 70, "Subsubsection"],
Cell[23888, 544, 734, 17, 70, "Input"],
Cell[24625, 563, 614, 15, 70, "Input"],
Cell[25242, 580, 1455, 35, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26734, 620, 398, 6, 70, "Subsubsection"],
Cell[27135, 628, 7019, 144, 70, "Input",
 InitializationCell->True],
Cell[34157, 774, 24631, 558, 70, "Input",
 InitializationCell->True],
Cell[58791, 1334, 2359, 51, 70, "Input"],
Cell[61153, 1387, 580, 13, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61770, 1405, 360, 5, 70, "Subsubsection"],
Cell[62133, 1412, 14906, 308, 70, "Input"],
Cell[77042, 1722, 744, 18, 70, "Input"],
Cell[77789, 1742, 171, 4, 70, "Input"],
Cell[77963, 1748, 59014, 1417, 70, "Input"],
Cell[136980, 3167, 1501, 21, 70, "Input"],
Cell[138484, 3190, 1716, 35, 70, "Input"],
Cell[140203, 3227, 234, 4, 70, "Input"],
Cell[140440, 3233, 1988, 40, 70, "Input"],
Cell[142431, 3275, 2912, 70, 70, "Input"],
Cell[145346, 3347, 152, 3, 70, "Input"],
Cell[145501, 3352, 706, 15, 70, "Input"],
Cell[146210, 3369, 2787, 66, 70, "Input"],
Cell[149000, 3437, 329, 6, 70, "Input"],
Cell[149332, 3445, 1841, 43, 70, "Input"],
Cell[151176, 3490, 7706, 216, 70, "Input"],
Cell[158885, 3708, 592, 15, 70, "Input"],
Cell[159480, 3725, 3093, 61, 70, "Input"],
Cell[162576, 3788, 1876, 27, 70, "Input"],
Cell[164455, 3817, 609, 13, 70, "Input"],
Cell[165067, 3832, 1474, 34, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166578, 3871, 415, 6, 70, "Subsubsection"],
Cell[166996, 3879, 37556, 908, 70, "Input"],
Cell[204555, 4789, 600, 16, 70, "Input"],
Cell[205158, 4807, 1371, 36, 70, "Input"],
Cell[206532, 4845, 22266, 550, 70, "Input"],
Cell[228801, 5397, 2104, 43, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230942, 5445, 562, 8, 70, "Subsubsection"],
Cell[231507, 5455, 1678, 49, 70, "Input"],
Cell[233188, 5506, 787, 22, 70, "Input"],
Cell[233978, 5530, 380, 11, 70, "Input"],
Cell[234361, 5543, 333, 7, 70, "Input"],
Cell[234697, 5552, 271, 8, 70, "Input"],
Cell[234971, 5562, 261, 6, 70, "Input"],
Cell[235235, 5570, 122, 2, 70, "Input"],
Cell[235360, 5574, 1729, 49, 70, "Input"],
Cell[237092, 5625, 373, 10, 70, "Input"],
Cell[237468, 5637, 1354, 43, 70, "Input"],
Cell[238825, 5682, 255, 6, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239117, 5693, 601, 9, 70, "Subsection"],
Cell[239721, 5704, 652, 14, 70, "Input"],
Cell[240376, 5720, 163, 4, 70, "Input"],
Cell[240542, 5726, 2052, 47, 70, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
